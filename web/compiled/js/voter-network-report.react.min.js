var VoterNetworkReportDatatable=React.createClass({displayName:"VoterNetworkReportDatatable",getInitialState:function(){return{target:null,typingTimer:null,doneTypingInterval:1500,barangay:{total_voter:0,total_recruits:0,percentage:0,municipality:""}}},getInitialProp:function(){return{municipalityNo:null,brgyNo:null}},componentDidMount:function(){this.gridTable(),this.loadBarangay(this.props.provinceCode,this.props.municipalityNo,this.props.brgyNo)},gridTable:function(){var e=this,t=new Datatable,a=$("#voter_table");t.init({src:a,dataTable:{bState:!0,autoWidth:!0,serverSide:!0,processing:!0,deferRender:!0,dom:'<"top">rt<"bottom"p><"clear">',ajax:{url:Routing.generate("ajax_datatable_voter_summary_item_detail"),type:"GET",data:function(t){t.provinceCode=e.props.provinceCode,t.municipalityNo=e.props.municipalityNo,t.brgyNo=e.props.brgyNo,t.voterName=$('#voter_table input[name="voter_name"]').val()}},columnDefs:[{className:"text-center valign-middle",orderable:!1,targets:[0,4,5,6]}],order:[[1,"asc"]],columns:[{data:null,className:"text-center",width:30,render:function(e,t,a,n){return n.settings._iDisplayStart+n.row+1}},{data:"voter_name",render:function(e,t,a){return(1==a.voted_2017?"*":"")+e}},{data:"barangay_name",className:"text-center",width:"150px"},{data:"precinct_no",className:"text-center",width:"80px"},{data:"node_level",className:"text-center",width:30},{data:"parent_id",className:"text-center",width:"80px",render:function(e){return 0==e?"YES":"NO"}},{data:"parent_id",width:200,className:"text-left",render:function(e,t,a){return a.parent.node_label}}]}}),e.grid=t},reload:function(){this.grid.getDataTable().ajax.reload()},handleFilterChange:function(){var e=this;clearTimeout(this.state.typingTimer),this.state.typingTimer=setTimeout(function(){e.reload()},this.state.doneTypingInterval)},isEmpty:function(e){return null==e||""==e||"undefined"==e},loadBarangay:function(e,t,a){var n=this;n.requestItems=$.ajax({url:Routing.generate("ajax_get_baranagy_full",{provinceCode:e,municipalityNo:t,brgyNo:a}),type:"GET"}).done(function(e){n.setState({barangay:e})})},render:function(){var e=this.isEmpty(this.grid)?{}:this.grid.getDataTable().ajax.params(),t=Routing.generate("ajax_datatable_voter_summary_item_detail_download",{provinceCode:this.isEmpty(this.props.provinceCode)?"":this.props.provinceCode,municipalityNo:this.isEmpty(this.props.municipalityNo)?"":this.props.municipalityNo,brgyNo:this.isEmpty(this.props.brgyNo)?"":this.props.brgyNo,precinctNo:this.isEmpty(this.props.precinctNo)?"":this.props.precinctNo,order:e.order,columns:e.columns}),a=Routing.generate("ajax_export_network_report_nodes_option2",{provinceCode:this.isEmpty(this.props.provinceCode)?"":this.props.provinceCode,municipalityNo:this.isEmpty(this.props.municipalityNo)?"":this.props.municipalityNo,brgyNo:this.isEmpty(this.props.brgyNo)?"":this.props.brgyNo,precinctNo:this.isEmpty(this.props.precinctNo)?"":this.props.precinctNo,order:e.order,columns:e.columns});return React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-8",style:{marginBottom:"10px"}},React.createElement("div",{style:{marginBottom:"5px"}},React.createElement("span",{className:"bold"},"City/Municipality : ",React.createElement("span",{className:"font-red-sunglo"},this.state.barangay.municipality)),React.createElement("span",{className:"bold",style:{marginLeft:"10px"}},"Barangay : ",React.createElement("span",{className:"font-red-sunglo"},this.state.barangay.name)," ")),React.createElement("div",{className:"bold"},"Registered : ",React.createElement("span",{className:"font-red-sunglo",style:{marginRight:"5px"}},this.state.barangay.total_voter),"Recruited : ",React.createElement("span",{className:"font-red-sunglo",style:{marginRight:"5px"}},this.state.barangay.total_recruits),"Percentage : ",React.createElement("span",{className:"font-red-sunglo"},parseFloat(this.state.barangay.percentage).toFixed(2)," %"))),React.createElement("div",{className:"col-md-4 text-right"},React.createElement("a",{href:t,target:"_self",className:"btn btn-sm btn-danger"},"Excel A"),React.createElement("a",{href:a,target:"_self",className:"btn btn-sm btn-danger",style:{marginLeft:"5px"}},"Excel B")),React.createElement("div",{className:"clearfix"}),React.createElement("div",{className:"col-md-12"},React.createElement("table",{id:"voter_table",className:"table table-striped table-bordered",width:"100%"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"#"),React.createElement("th",null,"Name"),React.createElement("th",null,"Barangay"),React.createElement("th",null,"Precinct"),React.createElement("th",null,"Level"),React.createElement("th",null,"Is Leader"),React.createElement("th",null,"Leader")),React.createElement("tr",null,React.createElement("td",null),React.createElement("td",{style:{padding:"10px 5px"}},React.createElement("input",{type:"text",className:"form-control form-filter input-sm",name:"voter_name",onChange:this.handleFilterChange})),React.createElement("td",null),React.createElement("td",null),React.createElement("td",null),React.createElement("td",null),React.createElement("td",null))),React.createElement("tbody",null))))}});window.VoterNetworkReportDatatable=VoterNetworkReportDatatable;var FormGroup=ReactBootstrap.FormGroup,HelpBlock=ReactBootstrap.HelpBlock,ControlLabel=ReactBootstrap.ControlLabel,FormControl=ReactBootstrap.FormControl,VoterNetworkReportHierarchyList=React.createClass({displayName:"VoterNetworkReportHierarchyList",getInitialState:function(){return{data:[],barangay:{total_voter:0,total_recruits:0,percentage:0,max_deep:0},loading:!1}},render:function(){var e=this,t=Routing.generate("ajax_export_network_report_nodes",{provinceCode:e.props.provinceCode,municipalityNo:e.props.municipalityNo,brgyNo:e.props.brgyNo,maxDeep:e.state.barangay.max_deep});return React.createElement("div",null,React.createElement("div",{className:"col-md-9",style:{padding:0,marginBottom:"10px"}},React.createElement("div",{style:{marginBottom:"5px"}},React.createElement("span",{className:"bold"},"City/Municipality : ",React.createElement("span",{className:"font-red-sunglo"},this.state.barangay.municipality)),React.createElement("span",{className:"bold",style:{marginLeft:"10px"}},"Barangay : ",React.createElement("span",{className:"font-red-sunglo"},this.state.barangay.name)," ")),React.createElement("div",{className:"bold"},"Registered : ",React.createElement("span",{className:"font-red-sunglo",style:{marginRight:"5px"}},this.state.barangay.total_voter),"Recruited : ",React.createElement("span",{className:"font-red-sunglo",style:{marginRight:"5px"}},this.state.barangay.total_recruits),"Percentage : ",React.createElement("span",{className:"font-red-sunglo",style:{marginRight:"5px"}},parseFloat(this.state.barangay.percentage).toFixed(2)," %"),"Max Deep : ",React.createElement("span",{className:"font-red-sunglo"},this.isEmpty(this.state.barangay.max_deep)?"0":this.state.barangay.max_deep," Levels"))),React.createElement("div",{className:"col-md-3 text-right",style:{padding:0}},React.createElement("button",{className:"btn btn-sm red-sunglo",onClick:this.downloadPdf},React.createElement("i",{className:"fa fa-file-pdf"})," PDF"),React.createElement("a",{className:"btn btn-sm green-jungle",href:t,style:{marginLeft:"10px"}},React.createElement("i",{className:"fa fa-file-excel"})," EXCEL")),React.createElement("div",{className:"clearfix"}),React.createElement("table",{id:"voter_network_table",className:"bg-default table table-striped table-bordered table-condensed",style:{fontSize:"12px"}},React.createElement("thead",{className:"bg-blue-dark font-white"},React.createElement("tr",null,React.createElement("th",{className:"text-center",style:{width:"23%",padding:"10px"}},"PARENT"),React.createElement("th",{className:"text-center",style:{width:"23%",padding:"10px"}},"MEMBER 1 "),React.createElement("th",{className:"text-center",style:{width:"23%",padding:"10px"}},"MEMBER 2 "),React.createElement("th",{className:"text-center",style:{width:"23%",padding:"10px"}},"MEMBER 3 "),React.createElement("th",{className:"text-center",style:{fontSize:"10px",width:"50px"}},"NO. OF MEMBERS"))),React.createElement("tbody",null,this.state.data.map(function(e,t){return React.createElement("tr",null,React.createElement("td",null,e[0]),React.createElement("td",null,e[1]),React.createElement("td",null,e[2]),React.createElement("td",null,e[3]),React.createElement("td",{className:"text-center"},Number.isInteger(e[4])&&0!=e[4]?e[4]:"- - -"))}),this.state.data.length<=0&&!this.state.loading&&React.createElement("tr",null,React.createElement("td",{colSpan:"5",className:"text-center"},"No data has found...")),this.state.loading&&React.createElement("tr",null,React.createElement("td",{colSpan:"5",className:"text-center"},"Requesting data from the server. This may take a while...")))))},componentDidMount:function(){this.loadBarangay(this.props.provinceCode,this.props.municipalityNo,this.props.brgyNo)},getView:function(e){var t=this;return React.createElement("li",null,e.node_label,React.createElement("ul",null,e.children.map(function(e){return t.getView(e)})))},apply:function(){this.loadData(),this.loadBarangay()},loadData:function(e,t,a,n){var r=this;r.requestData=$.ajax({url:Routing.generate("ajax_get_network_report_nodes",{provinceCode:e,municipalityNo:t,brgyNo:a,maxDeep:n}),type:"GET"}).done(function(e){r.setState({data:e})}).always(function(){r.setState({loading:!1})}),r.setState({loading:!0})},downloadPdf:function(){var e=[],t=new jsPDF("l","mm",[203.2,330.2]),a=this.state.barangay,n=this.state.data,r=function(e){var a="Page "+e.pageCount;"function"==typeof t.putTotalPages&&(a+=" of {total_pages_count_string}"),t.setFontSize(10),t.text(a,e.settings.margin.left,t.internal.pageSize.height-5),t.text("P4Change Generated At "+moment(new Date).format("dddd, MMMM Do YYYY, h:mm:ss a"),225,t.internal.pageSize.height-5)},o=parseInt(this.state.barangay.max_deep),i=0;if(o>3){i=6.8,e.push("Parent");for(var l=1;l<parseInt(this.state.barangay.max_deep);l++)e.push("Member "+l);e.push("Members"),n.map(function(e){e[o]=0!=parseInt(e[o])&&Number.isInteger(e[o])?e[o]:""})}else i=10,e.push("Parent"),e.push("Member 1"),e.push("Member 2"),e.push("Member 3"),e.push("Members"),n.map(function(e){e[4]=0!=parseInt(e[4])&&Number.isInteger(e[4])?e[4]:""}),o=4;t.setFontSize(12),t.text("City/Municipality : "+a.municipality,8,20),t.text("Registered Voter : "+a.total_voter,120,20),t.text("Percentage : "+parseFloat(a.percentage).toFixed(2)+" %",190,20),t.text("Barangay : "+a.name,8,26),t.text("Recruited Voter : "+a.total_recruits,120,26);var s={};s[o]={valign:"middle",fontStyle:"bold",halign:"center"},t.autoTable(e,n,{startY:30,showHeader:"firstPage",theme:"grid",margin:{top:10,bottom:10,left:7,right:7},styles:{columnWidth:"auto",overflow:"visible",fontSize:i,font:"Arial",cellPadding:1},columnStyles:s,addPageContent:r}),"function"==typeof t.putTotalPages&&t.putTotalPages("{total_pages_count_string}"),t.save(a.name+" "+moment(new Date).format()+".pdf")},loadBarangay:function(e,t,a){var n=this;n.requestItems=$.ajax({url:Routing.generate("ajax_get_baranagy_full",{provinceCode:e,municipalityNo:t,brgyNo:a}),type:"GET"}).done(function(r){n.loadData(e,t,a,r.max_deep),n.setState({barangay:r})})},isEmpty:function(e){return null==e||""==e||"undefined"==e}});window.VoterNetworkReportHierarchyList=VoterNetworkReportHierarchyList;var FormGroup=ReactBootstrap.FormGroup,HelpBlock=ReactBootstrap.HelpBlock,ControlLabel=ReactBootstrap.ControlLabel,FormControl=ReactBootstrap.FormControl,VoterNetworkReportComponent=React.createClass({displayName:"VoterNetworkReportComponent",getInitialState:function(){return{provinceCode:null,municipalityNo:null,brgyNo:null,data:[],barangay:{total_voter:0,total_recruits:0,percentage:0},displayMode:"HIERARCHY_LIST"}},notify:function(e,t){$.notific8("zindex",11500),$.notific8(e,{heading:"System Message",color:t,life:5e3,verticalEdge:"right",horizontalEdge:"top"})},render:function(){var e=this;Routing.generate("ajax_export_network_report_nodes",{municipalityNo:e.state.municipalityNo,brgyNo:e.state.brgyNo});return React.createElement("div",{className:"portlet light portlet-fit bordered"},React.createElement("div",{className:"portlet-body"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-3"},React.createElement("form",null,React.createElement(FormGroup,{controlId:"formProvinceCode"},React.createElement(ControlLabel,null," Province : "),React.createElement("select",{id:"form-province-select2",className:"form-control input-sm"})),React.createElement(FormGroup,{controlId:"formMunicipalityNo"},React.createElement(ControlLabel,null," Municipality : "),React.createElement("select",{id:"form-municipality-select2",className:"form-control input-sm"})),React.createElement(FormGroup,{controlId:"formBarangayNo"},React.createElement(ControlLabel,null," Barangay : "),React.createElement("select",{id:"form-barangay-select2",className:"form-control input-sm"})),React.createElement("input",{type:"checkbox",ref:"bsSwitch",id:"display_mode","data-handle-width":"120","data-on-text":"Hierarchy List","data-off-text":"By Precinct","data-size":"small",className:"make-switch","data-on-color":"success","data-off-color":"danger"})),React.createElement("button",{className:"btn btn-primary btn-sm",style:{width:"100%",marginTop:"35px"},onClick:this.apply},"Apply")),React.createElement("div",{className:"col-md-9"},this.state.showTable&&"HIERARCHY_LIST"==this.state.displayMode&&React.createElement(VoterNetworkReportHierarchyList,{provinceCode:this.state.provinceCode,municipalityNo:this.state.municipalityNo,brgyNo:this.state.brgyNo}),this.state.showTable&&"BY_PRECINCT"==this.state.displayMode&&React.createElement(VoterNetworkReportDatatable,{provinceCode:this.state.provinceCode,municipalityNo:this.state.municipalityNo,brgyNo:this.state.brgyNo})))))},componentDidMount:function(){this.loadUser(window.userId),this.initSelect2(),this.initSwitch()},loadUser:function(e){var t=this;t.requestUser=$.ajax({url:Routing.generate("ajax_get_user",{id:e}),type:"GET"}).done(function(e){t.setState({user:e},t.reinitSelect2)})},initSelect2:function(){var e=this;$("#form-province-select2").select2({casesentitive:!1,placeholder:"Enter Name...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_province"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.province_code,text:e.name}})}}}}),$("#form-municipality-select2").select2({casesentitive:!1,placeholder:"Enter Name...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_municipality_strict"),data:function(e){return{searchText:e.term,provinceCode:$("#form-province-select2").val()}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.municipality_no,text:e.name}})}}}}),$("#form-barangay-select2").select2({casesentitive:!1,placeholder:"Enter name...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_barangay_strict"),data:function(e){return{searchText:e.term,provinceCode:$("#form-province-select2").val(),municipalityNo:$("#form-municipality-select2").val()}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.brgy_no,text:e.name}})}}}}),$("#form-province-select2").on("change",function(){$("#form-municipality-select2").empty().trigger("change"),$("#form-barangay-select2").empty().trigger("change"),e.setState({provinceCode:$(this).val()})}),$("#form-municipality-select2").on("change",function(){$("#form-barangay-select2").empty().trigger("change"),e.setState({municipalityNo:$(this).val()})}),$("#form-barangay-select2").on("change",function(){e.setState({brgyNo:$(this).val()})})},reinitSelect2:function(){var e=this,t=e.state.user.province.provinceCode;e.requestProvince=$.ajax({url:Routing.generate("ajax_get_province",{provinceCode:t}),type:"GET"}).done(function(e){$("#form-province-select2").empty().append($("<option/>").val(e.province_code).text(e.name)).trigger("change")}),e.state.user.isAdmin||$("#form-province-select2").attr("disabled","disabled")},initSwitch:function(){var e=this;$("#display_mode").bootstrapSwitch({state:!0}),$("#display_mode").on("switchChange.bootstrapSwitch",function(t,a){var n=a?"HIERARCHY_LIST":"BY_PRECINCT";e.setState({displayMode:n})})},isEmpty:function(e){return""==e||null==e||"undefined"==e},apply:function(){var e=this.state.provinceCode,t=this.state.municipalityNo,a=this.state.brgyNo,n=this;this.isEmpty(t)||this.isEmpty(a)||this.isEmpty(e)?alert("Barangay cannot be empty."):(n.setState({showTable:!1}),setTimeout(function(){n.setState({showTable:!0})},500))}});setTimeout(function(){ReactDOM.render(React.createElement(VoterNetworkReportComponent,null),document.getElementById("voter-container"))},500);