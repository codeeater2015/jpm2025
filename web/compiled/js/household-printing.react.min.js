var HouseholdPrintingDatatable = React.createClass({displayName: "HouseholdPrintingDatatable",

    getInitialState: function () {
        return {
            householdData: []
        }
    },

    componentDidMount: function () {
        this.initSelect2();
    },

    initSelect2: function () {
        var self = this;

        $("#household_table #municipality_select2").select2({
            casesentitive: false,
            placeholder: "Enter Name...",
            allowClear: true,
            delay: 1500,
            width: '100%',
            containerCssClass: ':all:',
            ajax: {
                url: Routing.generate('ajax_select2_municipality'),
                data: function (params) {
                    return {
                        searchText: params.term,
                        provinceCode: 53
                    };
                },
                processResults: function (data, params) {
                    return {
                        results: data.map(function (item) {
                            return { id: item.municipality_no, text: item.name };
                        })
                    };
                },
            }
        });

        $("#household_table #barangay_select2").select2({
            casesentitive: false,
            placeholder: "Enter name...",
            allowClear: true,
            delay: 1500,
            width: '100%',
            containerCssClass: ':all:',
            ajax: {
                url: Routing.generate('ajax_select2_barangay'),
                data: function (params) {
                    return {
                        searchText: params.term,
                        provinceCode: 53,
                        municipalityNo: $("#household_table #municipality_select2").val()
                    };
                },
                processResults: function (data, params) {
                    return {
                        results: data.map(function (item) {
                            return { id: item.brgy_no, text: item.name };
                        })
                    };
                },
            }
        });

        $("#household_table #municipality_select2").on("change", function () {
            self.loadData();
        });

        $("#household_table #barangay_select2").on("change", function () {
            self.loadData();
        });

    },

    loadData: function () {

        let url = Routing.generate("ajax_get_table_household_headers", {
            municipalityName: $("#household_table #municipality_select2").val(),
            barangayName: $("#household_table #barangay_select2").val()
        }
        );

        var self = this;
        self.requestHierarchyData = $.ajax({
            url: url,
            type: "GET"
        }).done(function (res) {
            console.log("household data has been received");
            self.setState({ householdData: res });
        });
    },

    printPage: function () {
        console.log('printing');
        $.print("#household_table" /*, options*/);
    },

    render: function () {
        let counter = 0;

        return (
            React.createElement("div", null, 
                React.createElement("button", {type: "button", className: "btn btn-primary", onClick: this.printPage}, "Print Page"), 

                React.createElement("div", {id: "table-container", className: "table-container", style: { marginTop: "20px"}}, 
                    React.createElement("br", null), 
                    React.createElement("br", null), 
                    React.createElement("table", {id: "household_table", className: "table table-striped table-bordered", width: "100%"}, 
                        React.createElement("thead", null, 
                            React.createElement("tr", null, 
                                React.createElement("th", {rowSpan: "2"}, "No"), 
                                React.createElement("th", {rowSpan: "2"}, "Name"), 
                                React.createElement("th", {rowSpan: "2"}, "Municipality"), 
                                React.createElement("th", {rowSpan: "2", className: "text-center"}, "Barangay"), 
                                React.createElement("th", {rowSpan: "2", className: "text-center"}, "House No."), 
                                React.createElement("th", {style: { textAlign: "center"}, className: "text-center", colSpan: "3"}, "Household"), 
                                React.createElement("th", {rowSpan: "2", className: "text-center"}, "Contact #")
                            ), 
                            React.createElement("tr", null, 
                                React.createElement("th", {className: "text-center"}, "Voter"), 
                                React.createElement("th", {className: "text-center"}, "Non-Voter"), 
                                React.createElement("th", {className: "text-center"}, "Total")
                            ), 
                            React.createElement("tr", null, 
                                React.createElement("td", null), 
                                React.createElement("td", {style: { padding: "10px 5px"}}, 
                                    React.createElement("input", {type: "text", className: "form-control form-filter input-sm", name: "voter_name", onChange: this.handleFilterChange})
                                ), 
                                React.createElement("td", {style: { padding: "10px 5px"}}, 
                                    React.createElement("select", {id: "municipality_select2", className: "form-control form-filter input-sm"}
                                    )
                                ), 
                                React.createElement("td", {style: { padding: "10px 5px"}}, 
                                    React.createElement("select", {id: "barangay_select2", className: "form-control form-filter input-sm"}
                                    )
                                ), 
                                React.createElement("td", null, 
                                    React.createElement("input", {type: "text", className: "form-control form-filter input-sm", name: "household_code", onChange: this.handleFilterChange})
                                )
                            )
                        ), 
                        React.createElement("tbody", null, 
                            this.state.householdData.map(function (item, index) {
                                counter += 1;
                                return (
                                    React.createElement("tr", null, 
                                        React.createElement("td", {style: { textAlign: "center"}, className: "text-center"}, counter), 
                                        React.createElement("td", {style: { textAlign: "center"}, className: "text-center"}, " ", item.voter_name), 
                                        React.createElement("td", {style: { textAlign: "center"}, className: "text-center"}, item.municipality_name), 
                                        React.createElement("td", {style: { textAlign: "center"}, className: "text-center"}, item.barangay_name), 
                                        React.createElement("td", {style: { textAlign: "center"}, className: "text-center"}, item.household_code), 
                                        React.createElement("td", {style: { textAlign: "center"}, className: "text-center"}, item.total_voters), 
                                        React.createElement("td", {style: { textAlign: "center"}, className: "text-center"}, item.total_non_voters), 
                                        React.createElement("td", {style: { textAlign: "center"}, className: "text-center"}, item.total_members), 
                                        React.createElement("td", {style: { textAlign: "center"}, className: "text-center"}, item.contact_no)
                                    )
                                )
                            }), 
                            this.state.householdData.length == 0 ?
                                React.createElement("tr", null, 
                                    React.createElement("td", {colSpan: "9", className: "text-center"}, "No records was found...")
                                )
                                : ""
                            
                        )
                    )
                )
            )
        )
    }
});

window.HouseholdPrintingDatatable = HouseholdPrintingDatatable;
var HouseholdPrintingComponent = React.createClass({displayName: "HouseholdPrintingComponent",

    notify : function(message,color){
        $.notific8('zindex', 11500);
        $.notific8(message, {
            heading: 'System Message',
            color: color,
            life: 5000,
            verticalEdge: 'right',
            horizontalEdge: 'top',
        });
    },

    render : function(){
        return (
            React.createElement("div", {className: "portlet light portlet-fit bordered"}, 
                React.createElement("div", {className: "portlet-body"}, 
                    React.createElement(HouseholdPrintingDatatable, null)
                )
            )
        )
    }
});

setTimeout(function(){
    ReactDOM.render(
    React.createElement(HouseholdPrintingComponent, null),
        document.getElementById('page-container')
    );
},500);
