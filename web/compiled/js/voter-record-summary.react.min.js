var Modal=ReactBootstrap.Modal,VoterSummaryItemDetail=React.createClass({displayName:"VoterSummaryItemDetail",getInitialState:function(){return{target:null,typingTimer:null,doneTypingInterval:1500}},getInitialProp:function(){return{municipalityNo:null,brgyNo:null,precinctNo:null}},componentDidMount:function(){this.gridTable()},gridTable:function(){var e=this,t=new Datatable,a=$("#voter_table");t.init({src:a,dataTable:{bState:!0,autoWidth:!0,serverSide:!0,processing:!0,deferRender:!0,dom:'<"top">rt<"bottom"p><"clear">',ajax:{url:Routing.generate("ajax_datatable_voter_summary_item_detail"),type:"GET",data:function(t){t.provinceCode=e.props.provinceCode,t.municipalityNo=e.props.municipalityNo,t.brgyNo=e.props.brgyNo,t.precinctNo=e.props.precinctNo,t.voterName=$('#voter_table input[name="voter_name"]').val()}},columnDefs:[{className:"text-center valign-middle",orderable:!1,targets:[0,5,6]}],order:[[1,"asc"]],columns:[{data:null,className:"text-center",width:30,render:function(e,t,a,r){return r.settings._iDisplayStart+r.row+1}},{data:"voter_name"},{data:"voted_2017",width:40,className:"text-center",render:function(e){return 1==e?"YES":"NO"}},{data:"barangay_name",className:"text-center",width:"150px"},{data:"precinct_no",className:"text-center",width:"80px"},{data:"parent_id",className:"text-center",width:"80px",render:function(e){return 0==e?"YES":"NO"}},{data:"parent_id",width:200,className:"text-left",render:function(e,t,a){return a.parent.node_label}}]}}),e.grid=t},reload:function(){this.grid.getDataTable().ajax.reload()},handleFilterChange:function(){var e=this;clearTimeout(this.state.typingTimer),this.state.typingTimer=setTimeout(function(){e.reload()},this.state.doneTypingInterval)},isEmpty:function(e){return null==e||""==e||"undefined"==e},render:function(){var e=this.isEmpty(this.grid)?{}:this.grid.getDataTable().ajax.params(),t=Routing.generate("ajax_datatable_voter_summary_item_detail_download",{provinceCode:this.isEmpty(this.props.provinceCode)?"":this.props.provinceCode,municipalityNo:this.isEmpty(this.props.municipalityNo)?"":this.props.municipalityNo,brgyNo:this.isEmpty(this.props.brgyNo)?"":this.props.brgyNo,precinctNo:this.isEmpty(this.props.precinctNo)?"":this.props.precinctNo,order:e.order,columns:e.columns});return React.createElement(Modal,{keyboard:!1,enforceFocus:!1,dialogClassName:"modal-custom-85",backdrop:"static",show:this.props.show,onHide:this.props.onHide},React.createElement(Modal.Header,{className:"modal-header bg-blue-dark font-white",closeButton:!0},React.createElement(Modal.Title,null,"Item Details")),React.createElement(Modal.Body,{bsClass:"modal-body"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12"},React.createElement("div",{className:"text-right"},React.createElement("a",{href:t,target:"_self",className:"btn btn-sm btn-primary"},"Download Excel")),React.createElement("table",{id:"voter_table",className:"table table-striped table-bordered",width:"100%"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"#"),React.createElement("th",null,"Name"),React.createElement("th",null,"2016"),React.createElement("th",null,"Barangay"),React.createElement("th",null,"Precinct"),React.createElement("th",null,"Is Leader"),React.createElement("th",null,"Leader")),React.createElement("tr",null,React.createElement("td",null),React.createElement("td",{style:{padding:"10px 5px"}},React.createElement("input",{type:"text",className:"form-control form-filter input-sm",name:"voter_name",onChange:this.handleFilterChange})),React.createElement("td",null),React.createElement("td",null),React.createElement("td",null),React.createElement("td",null),React.createElement("td",null))),React.createElement("tbody",null))))))}});window.VoterSummaryItemDetail=VoterSummaryItemDetail;var VoterBarangaySummaryTable=React.createClass({displayName:"VoterBarangaySummaryTable",getInitialState:function(){return{data:[],barangay:{name:""},summary:{totalPrecincts:0,totalRegistered:0,totalRecruits:0,totalLeaders:0,totalMembers:0,percentage:0,total_has_cellphone:0},targetProvince:null,targetMunicipality:null,targetBarangay:null,targetPrecinct:null,showItemDetail:!1,loading:!1,refreshInterval:3e5,refreshCounter:0,refreshId:null,counterId:null,updating:!1}},componentDidMount:function(){var e=this;e.loadData(),e.initShortcuts();var t=setInterval(function(){e.loadData()},e.state.refreshInterval);e.setState({refreshId:t})},initShortcuts:function(){var e=this;$("body").keydown(function(t){121==(t.keyCode||t.which)&&(t.preventDefault(),e.loadData())})},componentWillUnmount:function(){clearInterval(this.state.refreshId)},loadData:function(){this.loadBarangayData(this.props.provinceCode,this.props.municipalityNo,this.props.brgyNo),this.loadBarangay(this.props.provinceCode,this.props.municipalityNo,this.props.brgyNo),this.initCounter()},recalculate:function(){var e=this,t={provinceCode:e.props.provinceCode,municipalityNo:e.props.municipalityNo,brgyNo:e.props.brgyNo};e.setState({updating:!0}),e.requestUpdateSummary=$.ajax({url:Routing.generate("ajax_update_summary"),type:"GET",data:t}).done(function(){e.loadData()}).always(function(){e.setState({updating:!1})})},initCounter:function(){var e=this,t=e.state.counterId;null!=t&&clearInterval(t);var t=setInterval(function(){var t=e.state.refreshCounter;t++,e.setState({refreshCounter:t})},1e3);e.setState({counterId:t,refreshCounter:0})},loadBarangayData:function(e,t,a){var r=this;r.requestProvinceData=$.ajax({url:Routing.generate("ajax_get_barangay_data_summary",{provinceCode:e,municipalityNo:t,brgyNo:a}),type:"GET"}).done(function(e){r.setState({data:e}),r.setSummary(e)})},loadBarangay:function(e,t,a){var r=this;r.requestMunicipality=$.ajax({url:Routing.generate("ajax_get_barangay",{provinceCode:e,municipalityNo:t,brgyNo:a}),type:"GET"}).done(function(e){r.setState({barangay:e})})},setSummary:function(e){var t=0,a=0,r=0,n=0,l=0,c=0;e.map(function(e){t++,a+=parseInt(e.total_voters),r+=parseInt(e.total_recruits),n+=parseInt(e.total_leaders),l+=parseInt(e.total_members)}),r>0&&(c=(r/a*100).toFixed(2));var s={totalPrecincts:t,totalRegistered:a,totalRecruits:r,percentage:c};this.setState({summary:s})},numberWithCommas:function(e){if(this.isEmpty(e)||isNaN(e))return 0;var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")},render:function(){var e=this,t=0,a=0,r=0,n=0,l=0,c=0;return e.state.data.map(function(e){a+=parseInt(e.total_voters),r+=parseInt(e.total_recruits),l+=parseInt(e.total_has_cellphone)}),n=(r/a*100).toFixed(2),c=(l/r*100).toFixed(2),React.createElement("div",null,e.state.showItemDetail&&!e.isEmpty(e.state.targetPrecinct)&&React.createElement(VoterSummaryItemDetail,{show:e.state.showItemDetail,onHide:e.closeDetailModal,provinceCode:e.state.targetProvince,municipalityNo:e.state.targetMunicipality,brgyNo:e.state.targetBarangay,precinctNo:e.state.targetPrecinct}),React.createElement("div",{style:{marginBottom:"5px"}},React.createElement("strong",null,"Barangay : ",this.state.barangay.name)),React.createElement("div",null,React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Total Precincts : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(this.state.summary.totalPrecincts))),React.createElement("div",{className:"bold"},"Registered Voter : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(this.state.summary.totalRegistered)))),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Recruited Voter : ",React.createElement("span",{className:"font-red-sunglo"}," ",this.numberWithCommas(this.state.summary.totalRecruits))),React.createElement("div",{className:"bold"},"Percentage : ",React.createElement("span",{className:"font-red-sunglo"}," ",this.numberWithCommas(this.state.summary.percentage)," %")," "))),React.createElement("div",{className:"clearfix"}),React.createElement("div",{style:{marginTop:"10px"}},React.createElement("div",{className:"bold",style:{marginBottom:"5px"}},"Filtered Summary: "),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Registered Voter : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(a)))),React.createElement("div",{className:"clearfix"}),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Recruited Voter : ",React.createElement("span",{className:"font-red-sunglo"}," ",this.numberWithCommas(r)))),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Percentage : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(n)," %"))),React.createElement("div",{className:"clearfix"}),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"With Cellphone : ",React.createElement("span",{className:"font-red-sunglo"}," ",this.numberWithCommas(l)))),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Percentage : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(c)," %")))),React.createElement("div",{className:"clearfix"}),React.createElement("div",{className:"text-right",style:{marginTop:"10px",marginBottom:"5px"}},React.createElement("small",null,"Next refresh : ",React.createElement("span",{className:"bold font-green-jungle"},this.state.refreshInterval/1e3-this.state.refreshCounter,"s")," "),React.createElement("button",{className:"btn btn-primary btn-xs",onClick:this.loadData},React.createElement("i",{className:"fa fa-refresh"})," Refresh (F10)"),!this.state.updating&&React.createElement("button",{className:"btn btn-danger btn-xs",onClick:this.recalculate,style:{marginLeft:"8px"}},"Update"),this.state.updating&&React.createElement("button",{className:"btn btn-danger btn-xs",onClick:this.recalculate,style:{marginLeft:"8px"}},React.createElement("i",{className:"fa fa-spinner fa-pulse fa-1x fa-fw"}),"Updating Please wait...")),React.createElement("div",{className:"table-container"},React.createElement("table",{id:"voter_summary_table",className:"table table-striped table-bordered",width:"100%"},React.createElement("thead",{className:"bg-blue-dark font-white"},React.createElement("tr",null,React.createElement("th",{className:"text-center",rowSpan:"2"},"#"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Prec"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Reg"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Voted"),React.createElement("th",{className:"text-center",colSpan:"8"},"Recruited Voter"),React.createElement("th",{className:"text-center",rowSpan:"2"})),React.createElement("tr",null,React.createElement("th",{className:"text-center"},"L"),React.createElement("th",{className:"text-center"},"M"),React.createElement("th",{className:"text-center"},"Total"),React.createElement("th",{className:"text-center"},"%"),React.createElement("th",{className:"text-center"},"Voted"),React.createElement("th",{className:"text-center"},"%"),React.createElement("th",{className:"text-center"},"CP"),React.createElement("th",{className:"text-center"},"%"))),React.createElement("tbody",null,this.state.data.map(function(a,r){return t++,React.createElement("tr",null,React.createElement("td",{className:"text-center"},++r),React.createElement("td",{className:"text-center"}," ",a.precinct_no," "),React.createElement("td",{className:"text-center"},0==a.total_voters?"- - -":e.numberWithCommas(a.total_voters)),React.createElement("td",{className:"text-center"},0==a.total_voted?"- - -":e.numberWithCommas(a.total_voted)),React.createElement("td",{className:"text-center"},0==a.total_leaders?"- - -":e.numberWithCommas(a.total_leaders)),React.createElement("td",{className:"text-center"},0==a.total_members?"- - -":e.numberWithCommas(a.total_members)),React.createElement("td",{className:"text-center"},0==a.total_recruits?"- - -":e.numberWithCommas(a.total_recruits)),React.createElement("td",{className:"text-center"},0==a.total_recruits?"- - -":(a.total_recruits/a.total_voters*100).toFixed(2)+" %"),React.createElement("td",{className:"text-center"},0==a.total_voted_recruits?"- - -":e.numberWithCommas(a.total_voted_recruits)),React.createElement("td",{className:"text-center"},0==a.total_voted_recruits?"- - -":(a.total_voted_recruits/a.total_recruits*100).toFixed(2)+" %"),React.createElement("td",{className:"text-center"},0==a.total_has_cellphone?"- - -":e.numberWithCommas(a.total_has_cellphone)),React.createElement("td",{className:"text-center"},0==a.total_has_cellphone?"- - -":(a.total_has_cellphone/a.total_recruits*100).toFixed(2)+"%"),React.createElement("td",{className:"text-center"},React.createElement("button",{className:"btn btn-primary btn-xs",type:"button",onClick:e.showDetail.bind(e,a)},React.createElement("small",null,"Details"))))}),0==this.state.data.length&&!this.state.loading&&React.createElement("tr",null,React.createElement("td",{colSpan:"13",className:"text-center"},"No records was found...")),this.state.loading&&React.createElement("tr",null,React.createElement("td",{colSpan:"13",className:"text-center"},"Data is being processed. Please wait for a while..."))))))},showDetail:function(e){var t=this;t.setState({targetProvince:t.props.provinceCode,targetMunicipality:t.props.municipalityNo,targetBarangay:t.props.brgyNo,targetPrecinct:e.precinct_no,showItemDetail:!0})},closeDetailModal:function(){this.setState({showItemDetail:!1,targetProvince:null,targetMunicipality:null,targetBarangay:null,targetPrecinct:null})},isEmpty:function(e){return null==e||""==e||"undefined"==e}});window.VoterBarangaySummaryTable=VoterBarangaySummaryTable;var VoterMunicipalitySummaryTable=React.createClass({displayName:"VoterMunicipalitySummaryTable",getInitialState:function(){return{data:[],municipality:{name:""},summary:{totalBarangay:0,totalPrecincts:0,totalRegistered:0,totalRecruits:0,totalLeaders:0,totalMembers:0,totalVoted:0,totalVotedRecruits:0,totalHasCellphone:0,percentage:0,deep:1},targetBarangay:null,targetMunicipality:null,showItemDetail:!1,loading:!1,refreshInterval:3e5,refreshCounter:0,refreshId:null,counterId:null,mode:"all",updating:!1}},componentDidMount:function(){var e=this;e.loadData(),e.initShortcuts();var t=setInterval(function(){e.loadData()},e.state.refreshInterval);e.setState({refreshId:t})},initShortcuts:function(){var e=this;$("body").keydown(function(t){121==(t.keyCode||t.which)&&(t.preventDefault(),e.loadData())})},componentWillUnmount:function(){clearInterval(this.state.refreshId),clearInterval(this.state.counterId)},initCounter:function(){var e=this,t=e.state.counterId;null!=t&&clearInterval(t);var t=setInterval(function(){var t=e.state.refreshCounter;t++,e.setState({refreshCounter:t})},1e3);e.setState({counterId:t,refreshCounter:0})},loadData:function(){this.loadMunicipalityData(this.props.provinceCode,this.props.municipalityNo),this.loadMunicipality(this.props.provinceCode,this.props.municipalityNo),this.initCounter()},recalculate:function(){var e=this,t={provinceCode:e.props.provinceCode,municipalityNo:e.props.municipalityNo};e.setState({updating:!0}),e.requestUpdateSummary=$.ajax({url:Routing.generate("ajax_update_summary"),type:"GET",data:t}).done(function(){e.loadData()}).always(function(){e.setState({updating:!1})})},loadMunicipalityData:function(e,t){var a=this;a.requestProvinceData=$.ajax({url:Routing.generate("ajax_get_municipality_data_summary",{provinceCode:e,municipalityNo:t}),type:"GET"}).done(function(e){a.setState({data:e}),a.setSummary(e)})},setSummary:function(e){var t=0,a=0,r=0,n=0,l=0,c=0,s=0;e.map(function(e){t++,a+=parseInt(e.total_precincts),r+=parseInt(e.total_voters),n+=parseInt(e.total_recruits),l+=parseInt(e.total_leaders),c+=parseInt(e.total_members)}),n>0&&(s=(n/r*100).toFixed(2));var i={totalBarangay:t,totalPrecincts:a,totalRegistered:r,totalRecruits:n,totalLeaders:l,totalMembers:c,percentage:s};this.setState({summary:i})},loadMunicipality:function(e,t){var a=this;a.requestMunicipality=$.ajax({url:Routing.generate("ajax_get_municipality",{provinceCode:e,municipalityNo:t}),type:"GET"}).done(function(e){console.log("municipality"),console.log(e),a.setState({municipality:e})})},numberWithCommas:function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")},render:function(){var e=this,t=0,a=0,r=0,n=0,l=0,c=0;return e.state.data.map(function(t){e.display(t)&&(a+=parseInt(t.total_voters),r+=parseInt(t.total_recruits),l+=parseInt(t.total_has_cellphone))}),n=(r/a*100).toFixed(2),c=(l/r*100).toFixed(2),React.createElement("div",null,e.state.showItemDetail&&!e.isEmpty(e.state.targetBarangay)&&React.createElement(VoterSummaryItemDetail,{provinceCode:e.state.targetProvince,municipalityNo:e.state.targetMunicipality,brgyNo:e.state.targetBarangay,show:e.state.showItemDetail,onHide:e.closeDetailModal}),React.createElement("div",{style:{marginBottom:"5px"}},React.createElement("strong",null,"City/Municipality : ",this.state.municipality.name)),React.createElement("div",null,React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Total Barangay : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(this.state.summary.totalBarangay))),React.createElement("div",{className:"bold"},"Total Precincts : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(this.state.summary.totalPrecincts)))),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Registered Voter : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(this.state.summary.totalRegistered))),React.createElement("div",{className:"bold"},"Recruited Voter : ",React.createElement("span",{className:"font-red-sunglo"}," ",this.numberWithCommas(this.state.summary.totalRecruits)))),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Percentage : ",React.createElement("span",{className:"font-red-sunglo"}," ",this.numberWithCommas(this.state.summary.percentage)," %")," "))),React.createElement("div",{className:"clearfix"}),React.createElement("div",{style:{marginTop:"10px"}},React.createElement("div",{className:"bold",style:{marginBottom:"5px"}},"Filtered Summary: "),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Registered Voter : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(a)))),React.createElement("div",{className:"clearfix"}),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Recruited Voter : ",React.createElement("span",{className:"font-red-sunglo"}," ",this.numberWithCommas(r)))),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Percentage : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(n)," %"))),React.createElement("div",{className:"clearfix"}),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"With Cellphone : ",React.createElement("span",{className:"font-red-sunglo"}," ",this.numberWithCommas(l)))),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Percentage : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(c)," %")))),React.createElement("div",{className:"clearfix"}),React.createElement("div",{className:"col-md-6",style:{padding:"0"}},React.createElement("select",{value:this.state.mode,onChange:e.setMode,style:{marginTop:"8px"}},React.createElement("option",{value:"all"}," All"),React.createElement("option",{value:"active"},"Active"),React.createElement("option",{value:"has_entry"},"Has Entry"),React.createElement("option",{value:"no_entry"},"No Entry"))),React.createElement("div",{className:"col-md-6 text-right",style:{marginTop:"10px",marginBottom:"5px",padding:"0"}},React.createElement("small",null,"Next refresh : ",React.createElement("span",{className:"bold font-green-jungle"},this.state.refreshInterval/1e3-this.state.refreshCounter,"s")," "),React.createElement("button",{className:"btn btn-primary btn-xs",onClick:this.loadData},React.createElement("i",{className:"fa fa-refresh"})," Refresh (F10)"),!this.state.updating&&React.createElement("button",{className:"btn btn-danger btn-xs",onClick:this.recalculate,style:{marginLeft:"8px"}},"Update"),this.state.updating&&React.createElement("button",{className:"btn btn-danger btn-xs",onClick:this.recalculate,style:{marginLeft:"8px"}},React.createElement("i",{className:"fa fa-spinner fa-pulse fa-1x fa-fw"}),"Updating Please wait...")),React.createElement("div",{className:"table-container"},React.createElement("table",{id:"voter_summary_table",className:"table table-striped table-bordered",width:"100%"},React.createElement("thead",{className:"bg-blue-dark font-white"},React.createElement("tr",null,React.createElement("th",{className:"text-center",rowSpan:"2"},"#"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Brgy"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Prec"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Reg"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Voted"),React.createElement("th",{className:"text-center",colSpan:"8"},"Recruited Voter"),React.createElement("th",{className:"text-center",rowSpan:"2"})),React.createElement("tr",null,React.createElement("th",{className:"text-center"},"L"),React.createElement("th",{className:"text-center"},"M"),React.createElement("th",{className:"text-center"},"Total"),React.createElement("th",{className:"text-center"},"%"),React.createElement("th",{className:"text-center"},"Voted"),React.createElement("th",{className:"text-center"},"%"),React.createElement("th",{className:"text-center"},"CP"),React.createElement("th",{className:"text-center"},"%"))),React.createElement("tbody",null,this.state.data.map(function(a,r){if(e.display(a))return t+=1,React.createElement("tr",null,React.createElement("td",{className:"text-center"},t),React.createElement("td",{className:"text-center"},a.name,!e.isEmpty(a.updated_at)&&React.createElement("span",{className:"font-green-jungle bold",style:{fontSize:"10px",marginLeft:"5px"}},moment(new Date(a.updated_at)).fromNow())),React.createElement("td",{className:"text-center"},0==a.total_precincts?"- - -":e.numberWithCommas(a.total_precincts)),React.createElement("td",{className:"text-center"},0==a.total_voters?"- - -":e.numberWithCommas(a.total_voters)),React.createElement("td",{className:"text-center"},0==a.total_voted?"- - -":e.numberWithCommas(a.total_voted)),React.createElement("td",{className:"text-center"},0==a.total_leaders?"- - -":e.numberWithCommas(a.total_leaders)),React.createElement("td",{className:"text-center"},0==a.total_members?"- - -":e.numberWithCommas(a.total_members)),React.createElement("td",{className:"text-center"},0==a.total_recruits?"- - -":e.numberWithCommas(a.total_recruits)),React.createElement("td",{className:"text-center"},0==a.total_recruits?"- - -":(a.total_recruits/a.total_voters*100).toFixed(2)+"%"),React.createElement("td",{className:"text-center"},0==a.total_voted_recruits?"- - -":e.numberWithCommas(a.total_voted_recruits)),React.createElement("td",{className:"text-center"},0==a.total_voted_recruits?"- - -":(a.total_voted_recruits/a.total_recruits*100).toFixed(2)+"%"),React.createElement("td",{className:"text-center"},0==a.total_has_cellphone?"- - -":e.numberWithCommas(a.total_has_cellphone)),React.createElement("td",{className:"text-center"},0==a.total_has_cellphone?"- - -":(a.total_has_cellphone/a.total_recruits*100).toFixed(2)+"%"),React.createElement("td",{className:"text-center"},React.createElement("button",{className:"btn btn-primary btn-xs",type:"button",onClick:e.showDetail.bind(e,a)},React.createElement("small",null,"Details"))))}),0==this.state.data.length&&!this.state.loading&&React.createElement("tr",null,React.createElement("td",{colSpan:"14",className:"text-center"},"No records was found...")),this.state.loading&&React.createElement("tr",null,React.createElement("td",{colSpan:"14",className:"text-center"},"Data is being processed. Please wait for a while..."))))))},setMode:function(e){this.setState({mode:e.target.value})},showDetail:function(e){var t=this;t.setState({targetProvince:t.props.provinceCode,targetMunicipality:t.props.municipalityNo,targetBarangay:e.brgy_no,showItemDetail:!0})},closeDetailModal:function(){this.setState({showItemDetail:!1,targetMunicipality:null})},isEmpty:function(e){return null==e||""==e||"undefined"==e},display:function(e){var t=this.state.mode;return"all"==t||("active"==t?this.isActive(e.updated_at):"no_entry"==t?0==e.total_recruits:"has_entry"==t&&e.total_recruits>0)},isActive:function(e){if(this.isEmpty(e))return!1;var t=new Date,a=new Date(e),r=t-a,n=Math.floor(r/864e5),l=Math.floor(r%864e5/36e5),c=Math.round(r%864e5%36e5/6e4);return t.getTime()<a.getTime()||0==n&&0==l&&c<=10}});window.VoterMunicipalitySummaryTable=VoterMunicipalitySummaryTable;var VoterProvinceSummaryTable=React.createClass({displayName:"VoterProvinceSummaryTable",getInitialState:function(){return{data:[],summary:{totalMunicipality:0,totalBarangay:0,totalPrecincts:0,totalRegistered:0,totalRecruits:0,totalLeaders:0,totalMembers:0,totalVoted:0,totalVotedRecruits:0,percentage:0},province:{name:""},targetProvince:null,targetMunicipality:null,showItemDetail:!1,loading:!1,refreshInterval:3e5,refreshCounter:0,refreshId:null,counterId:null,mode:"all"}},componentDidMount:function(){var e=this;e.loadData(),e.initShortcuts();var t=setInterval(function(){e.loadData()},e.state.refreshInterval);e.setState({refreshId:t})},componentWillUnmount:function(){clearInterval(this.state.refreshId),clearInterval(this.state.counterId)},initShortcuts:function(){var e=this;$("body").keydown(function(t){121==(t.keyCode||t.which)&&(t.preventDefault(),e.loadData())})},initCounter:function(){var e=this,t=e.state.counterId;null!=t&&clearInterval(t);var t=setInterval(function(){var t=e.state.refreshCounter;t++,e.setState({refreshCounter:t})},1e3);e.setState({counterId:t,refreshCounter:0})},loadData:function(){this.loadProvince(this.props.provinceCode),this.loadProvinceData(this.props.provinceCode),this.initCounter()},loadProvince:function(e){var t=this;t.requestProvince=$.ajax({url:Routing.generate("ajax_get_province",{provinceCode:e}),type:"GET"}).done(function(e){t.setState({province:e})})},loadProvinceData:function(e){var t=this;t.requestProvinceData=$.ajax({url:Routing.generate("ajax_get_province_data_summary",{provinceCode:e}),type:"GET"}).done(function(e){t.setState({data:e}),t.setSummary(e)}).always(function(){t.setState({loading:!1})}),t.setState({loading:!0})},setSummary:function(e){var t=0,a=0,r=0,n=0,l=0,c=0,s=0;e.map(function(e){t+=parseInt(e.total_barangays),a+=parseInt(e.total_precincts),r+=parseInt(e.total_voters),c+=parseInt(e.total_recruits),n+=parseInt(e.total_leaders),l+=parseInt(e.total_members)}),c>0&&(s=(c/r*100).toFixed(2));var i={totalBarangay:t,totalPrecincts:a,totalRegistered:r,totalRecruits:c,percentage:s};this.setState({summary:i})},numberWithCommas:function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")},render:function(){var e=this,t=0,a=0,r=0,n=0;return e.state.data.map(function(t){e.display(t)&&(a+=parseInt(t.total_voters),r+=parseInt(t.total_recruits))}),n=(r/a*100).toFixed(2),React.createElement("div",null,e.state.showItemDetail&&!e.isEmpty(e.state.targetMunicipality)&&React.createElement(VoterSummaryItemDetail,{provinceCode:e.state.targetProvince,municipalityNo:e.state.targetMunicipality,show:e.state.showItemDetail,onHide:e.closeDetailModal}),React.createElement("div",{style:{marginBottom:"5px"}},React.createElement("strong",null,"Province : ",this.state.province.name)),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Total Barangay : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(this.state.summary.totalBarangay))),React.createElement("div",{className:"bold"},"Total Precincts : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(this.state.summary.totalPrecincts)))),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Registered Voter : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(this.state.summary.totalRegistered))),React.createElement("div",{className:"bold"},"Recruited Voter : ",React.createElement("span",{className:"font-red-sunglo"}," ",this.numberWithCommas(this.state.summary.totalRecruits)))),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Percentage : ",React.createElement("span",{className:"font-red-sunglo"}," ",this.numberWithCommas(this.state.summary.percentage)," %")," ")),React.createElement("div",{className:"clearfix"}),React.createElement("div",{style:{marginTop:"10px"}},React.createElement("div",{className:"bold",style:{marginBottom:"5px"}},"Filtered Summary: "),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Registered Voter : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(a))),React.createElement("div",{className:"bold"},"Recruited Voter : ",React.createElement("span",{className:"font-red-sunglo"}," ",this.numberWithCommas(r)))),React.createElement("div",{className:"col-md-3",style:{padding:0}},React.createElement("div",{className:"bold"},"Percentage : ",React.createElement("span",{className:"font-red-sunglo"},this.numberWithCommas(n)," %")))),React.createElement("div",{className:"clearfix"}),React.createElement("div",{className:"col-md-6",style:{padding:"0"}},React.createElement("select",{value:this.state.mode,onChange:e.setMode,style:{marginTop:"8px"}},React.createElement("option",{value:"all"}," All"),React.createElement("option",{value:"active"},"Active"),React.createElement("option",{value:"has_entry"},"Has Entry"),React.createElement("option",{value:"no_entry"},"No Entry"))),React.createElement("div",{className:"col-md-6 text-right",style:{marginTop:"10px",marginBottom:"5px",padding:"0"}},React.createElement("small",null,"Next refresh : ",React.createElement("span",{className:"bold font-green-jungle"},this.state.refreshInterval/1e3-this.state.refreshCounter,"s")," "),React.createElement("button",{className:"btn btn-primary btn-xs",onClick:this.loadData},React.createElement("i",{className:"fa fa-refresh"})," Refresh (F10)")),React.createElement("div",{className:"table-container"},React.createElement("table",{id:"voter_summary_table",className:"table table-striped table-bordered",width:"100%"},React.createElement("thead",{className:"bg-blue-dark font-white"},React.createElement("tr",null,React.createElement("th",{className:"text-center",rowSpan:"2"},"#"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Mun"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Brgy"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Prec"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Reg"),React.createElement("th",{className:"text-center",rowSpan:"2"},"Voted"),React.createElement("th",{className:"text-center",colSpan:"6"},"Recuited Voter"),React.createElement("th",{className:"text-center",rowSpan:"2"
})),React.createElement("tr",null,React.createElement("th",{className:"text-center"},"L"),React.createElement("th",{className:"text-center"},"M"),React.createElement("th",{className:"text-center"},"Total"),React.createElement("th",{className:"text-center"},"%"),React.createElement("th",{className:"text-center"},"Voted"),React.createElement("th",{className:"text-center"},"%"))),React.createElement("tbody",null,this.state.data.map(function(a,r){if(e.display(a))return t+=1,React.createElement("tr",null,React.createElement("td",{className:"text-center"},t),React.createElement("td",{className:"text-center"},a.name,!e.isEmpty(a.updated_at)&&React.createElement("span",{className:"font-green-jungle bold",style:{fontSize:"10px",marginLeft:"5px"}},moment(new Date(a.updated_at)).fromNow())),React.createElement("td",{className:"text-center"},0==a.total_barangays?"- - -":e.numberWithCommas(a.total_barangays)),React.createElement("td",{className:"text-center"},0==a.total_precincts?"- - -":e.numberWithCommas(a.total_precincts)),React.createElement("td",{className:"text-center"},0==a.total_voters?"- - -":e.numberWithCommas(a.total_voters)),React.createElement("td",{className:"text-center"},0==a.total_voted?"- - -":e.numberWithCommas(a.total_voted)),React.createElement("td",{className:"text-center"},0==a.total_leaders?"- - -":e.numberWithCommas(a.total_leaders)),React.createElement("td",{className:"text-center"},0==a.total_members?"- - -":e.numberWithCommas(a.total_members)),React.createElement("td",{className:"text-center"},0==a.total_recruits?"- - -":e.numberWithCommas(a.total_recruits)),React.createElement("td",{className:"text-center"},0==a.total_recruits?"- - -":(a.total_recruits/a.total_voters*100).toFixed(2)+"%"),React.createElement("td",{className:"text-center"},0==a.total_voted_recruits?"- - -":e.numberWithCommas(a.total_voted_recruits)),React.createElement("td",{className:"text-center"},0==a.total_voted_recruits?"- - -":(a.total_voted_recruits/a.total_recruits*100).toFixed(2)+"%"),React.createElement("td",{className:"text-center"},React.createElement("button",{className:"btn btn-primary btn-xs",type:"button",onClick:e.showDetail.bind(e,a)},React.createElement("small",null,"Details"))))}),0==this.state.data.length&&!this.state.loading&&React.createElement("tr",null,React.createElement("td",{className:"text-center",colSpan:"13"},"No records was found...")),this.state.loading&&React.createElement("tr",null,React.createElement("td",{className:"text-center",colSpan:"13"},"Data is being processed. Please wait for a while..."))))))},setMode:function(e){this.setState({mode:e.target.value})},showDetail:function(e){var t=this;t.setState({targetProvince:t.props.provinceCode,targetMunicipality:e.municipality_no,showItemDetail:!0})},closeDetailModal:function(){this.setState({showItemDetail:!1,targetMunicipality:null})},isEmpty:function(e){return null==e||""==e||"undefined"==e},display:function(e){var t=this.state.mode;return"all"==t||("active"==t?this.isActive(e.updated_at):"no_entry"==t?0==e.total_recruits:"has_entry"==t&&e.total_recruits>0)},isActive:function(e){if(this.isEmpty(e))return!1;var t=new Date,a=new Date(e),r=t-a,n=Math.floor(r/864e5),l=Math.floor(r%864e5/36e5),c=Math.round(r%864e5%36e5/6e4);return t.getTime()<a.getTime()||0==n&&0==l&&c<=10}});window.VoterProvinceSummaryTable=VoterProvinceSummaryTable;var VoterSummaryComponent=React.createClass({displayName:"VoterSummaryComponent",getInitialState:function(){return{provinceCode:null,municipalityNo:null,brgyNo:null,displayBarangayTable:!1,displayMunicipalityTable:!1,displayProvinceTable:!1}},notify:function(e,t){$.notific8("zindex",11500),$.notific8(e,{heading:"System Message",color:t,life:5e3,verticalEdge:"right",horizontalEdge:"top"})},render:function(){return React.createElement("div",{id:"voter_record_summary",className:"portlet light portlet-fit bordered"},React.createElement("div",{className:"portlet-body"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-3"},React.createElement("form",null,React.createElement("div",{className:"form-group"},React.createElement("label",{className:"control-label"},"Province"),React.createElement("select",{id:"province_select2",className:"form-control form-filter input-sm",name:"provinceCode"})),React.createElement("div",{className:"form-group"},React.createElement("label",{className:"control-label"},"City/Municipality"),React.createElement("select",{id:"municipality_select2",className:"form-control form-filter input-sm",name:"municipalityNo"})),React.createElement("div",{className:"form-group"},React.createElement("label",{className:"control-label"},"Barangay"),React.createElement("select",{id:"barangay_select2",className:"form-control form-filter input-sm",name:"brgyNo"})),React.createElement("div",null,React.createElement("button",{type:"button",style:{width:"100%"},className:"btn btn-primary",onClick:this.displayTable},"Apply")))),React.createElement("div",{className:"col-md-9",style:{padding:"0px"}},this.state.displayProvinceTable&&React.createElement(VoterProvinceSummaryTable,{provinceCode:this.state.provinceCode,notify:this.notify}),this.state.displayMunicipalityTable&&React.createElement(VoterMunicipalitySummaryTable,{provinceCode:this.state.provinceCode,municipalityNo:this.state.municipalityNo,notify:this.notify}),this.state.displayBarangayTable&&React.createElement(VoterBarangaySummaryTable,{provinceCode:this.state.provinceCode,municipalityNo:this.state.municipalityNo,brgyNo:this.state.brgyNo,notify:this.notify}),!this.state.displayProvinceTable&&!this.state.displayMunicipalityTable&&!this.state.displayBarangayTable&&React.createElement("div",{style:{marginTop:"10px"}},"This area was intentionally left blank...")))))},componentDidMount:function(){this.initSelect2(),this.loadUser(window.userId)},loadUser:function(e){var t=this;t.requestUser=$.ajax({url:Routing.generate("ajax_get_user",{id:e}),type:"GET"}).done(function(e){t.setState({user:e},t.reinitSelect2)})},initSelect2:function(){var e=this;$("#voter_record_summary #province_select2").select2({casesentitive:!1,placeholder:"Select Province",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_province_strict"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.province_code,text:e.name}})}}}}),$("#voter_record_summary #municipality_select2").select2({casesentitive:!1,placeholder:"Select City/Municipality",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_municipality_strict"),data:function(t){return{searchText:t.term,provinceCode:e.state.provinceCode}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.municipality_no,text:e.name}})}}}}),$("#voter_record_summary #barangay_select2").select2({casesentitive:!1,placeholder:"Select Barangay",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_barangay_strict"),data:function(t){return{searchText:t.term,municipalityNo:$("#voter_record_summary #municipality_select2").val(),provinceCode:e.state.provinceCode}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.brgy_no,text:e.name}})}}}}),$("#voter_record_summary #province_select2").on("change",function(){$("#voter_record_summary #municipality_select2").empty().trigger("change"),$("#voter_record_summary #barangay_select2").empty().trigger("change"),e.setState({provinceCode:$(this).val()})}),$("#voter_record_summary #municipality_select2").on("change",function(){$("#voter_record_summary #barangay_select2").empty().trigger("change"),e.setState({municipalityNo:$(this).val()})}),$("#voter_record_summary #barangay_select2").on("change",function(){e.setState({brgyNo:$(this).val()})})},reinitSelect2:function(){var e=this,t=e.state.user.province.provinceCode;e.requestProvince=$.ajax({url:Routing.generate("ajax_get_province",{provinceCode:t}),type:"GET"}).done(function(e){$("#voter_record_summary #province_select2").empty().append($("<option/>").val(e.province_code).text(e.name)).trigger("change")}),e.state.user.isAdmin||$("#voter_record_summary #province_select2").attr("disabled","disabled")},displayTable:function(){var e=this,t=this.state.provinceCode,a=this.state.municipalityNo,r=this.state.brgyNo,n=!1,l=!1,c=!1;this.isEmpty(a)&&this.isEmpty(r)&&!this.isEmpty(t)?(n=!0,l=!1,c=!1):!this.isEmpty(a)&&this.isEmpty(r)?(n=!1,l=!0,c=!1):this.isEmpty(a)||this.isEmpty(r)||(n=!1,l=!1,c=!0),console.log(this.state),this.setState({displayProvinceTable:!1,displayMunicipalityTable:!1,displayBarangayTable:!1}),setTimeout(function(){e.setState({displayProvinceTable:n,displayMunicipalityTable:l,displayBarangayTable:c})},1e3)},isEmpty:function(e){return null==e||""==e||"undefined"==e},retrieve:function(){console.log("retrieving  data")}});setTimeout(function(){ReactDOM.render(React.createElement(VoterSummaryComponent,null),document.getElementById("voter-summary-container"))},500);