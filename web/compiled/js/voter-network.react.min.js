var Modal=ReactBootstrap.Modal,FormGroup=ReactBootstrap.FormGroup,HelpBlock=ReactBootstrap.HelpBlock,ControlLabel=ReactBootstrap.ControlLabel,FormControl=ReactBootstrap.FormControl,VoterNetworkRootCreateModal=React.createClass({displayName:"VoterNetworkRootCreateModal",getInitialState:function(){return{form:{data:{voterId:null,nodeLabel:"",parentId:0,cellphoneNo:"",remarks:""},errors:[]},parentNode:null}},componentDidMount:function(){this.initSelect2()},initSelect2:function(){var e=this;$("#form-voter-select2").select2({casesentitive:!1,placeholder:"Enter Name...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",dropdownCssClass:"custom-option",ajax:{url:Routing.generate("ajax_select2_groupless_voter"),data:function(t){return{searchText:t.term,electId:e.props.electId,proId:e.props.proId,provinceCode:e.props.provinceCode,municipalityNo:e.props.municipalityNo,brgyNo:e.props.brgyNo}},processResults:function(e,t){return{results:e.map(function(e){var t="",a=!1,o=1==e.voted_2017?"*":"";return 1==e.in_network?(t=o+e.voter_name+" ("+(e.is_leader?"LEADER":"MEMBER")+") - "+e.precinct_no,a=!0):t=o+e.voter_name+" - "+e.precinct_no,{id:e.voter_id,text:t,disabled:a}})}}}}),$("#voter-group-select2").select2({casesentitive:!1,placeholder:"Enter Group",width:"100%",allowClear:!0,tags:!0,containerCssClass:":all:",createTag:function(e){return{id:e.term,text:e.term,newOption:!0}},ajax:{url:Routing.generate("ajax_select2_voter_group"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.voter_group,text:e.voter_group}})}}}}),$("#form-voter-select2").on("change",function(){e.loadVoter(e.props.proId,$(this).val())}),$("#voter-group-select2").on("change",function(){e.setFieldValue("voterGroup",$(this).val())})},loadVoter:function(e,t){var a=this;a.requestVoter=$.ajax({url:Routing.generate("ajax_get_project_voter",{proId:e,voterId:t}),type:"GET"}).done(function(e){var t=a.state.form;t.data.nodeLabel=e.voterName,t.data.nodeOrder=10,t.data.municipalityNo=e.municipalityNo,t.data.brgyNo=e.brgyNo,t.data.voterId=e.voterId,t.data.cellphoneNo=a.isEmpty(e.cellphoneNo)?"":e.cellphoneNo,t.data.voterGroup=e.voterGroup,t.data.remarks=a.isEmpty(e.remarks)?"":e.remarks,$("#voter-group-select2").empty().append($("<option/>").val(e.voterGroup).text(e.voterGroup)).trigger("change"),a.setState({form:t})})},setFormProp:function(e){var t=this.state.form;t.data[e.target.name]=e.target.value,this.setState({form:t})},setFieldValue:function(e,t){var a=this.state.form;a.data[e]=t,this.setState({form:a})},setErrors:function(e){var t=this.state.form;t.errors=e,this.setState({form:t})},getError:function(e){var t=this.state.form.errors;for(var a in t)if(a==e)return t[e];return null},getValidationState:function(e){return null!=this.getError(e)?"error":""},isEmpty:function(e){return null==e||""==e},submit:function(e){e.preventDefault();var t=this,a=t.state.form.data;t.requestNode=$.ajax({url:Routing.generate("ajax_post_root_node",{proId:t.props.proId,voterId:a.voterId}),type:"POST",data:a}).done(function(e){console.log("node id"),console.log(e),t.props.onSuccess(e.nodeId),t.props.notify("Head branch has been added.","teal")}).fail(function(e){t.setErrors(e.responseJSON)})},render:function(){var e=this;e.state.form.data;return React.createElement(Modal,{keyboard:!1,enforceFocus:!1,dialogClassName:"modal-custom-40",backdrop:"static",show:this.props.show,onHide:this.props.onHide},React.createElement(Modal.Header,{className:"modal-header bg-blue-dark font-white",closeButton:!0},React.createElement(Modal.Title,null,"Network Form")),React.createElement(Modal.Body,{bsClass:"modal-body overflow-auto"},React.createElement("form",{id:"voter-node-form",onSubmit:this.submit},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12"},React.createElement(FormGroup,{controlId:"formVoterId",validationState:this.getValidationState("voterId")},React.createElement(ControlLabel,null," Voter Name : "),React.createElement("select",{id:"form-voter-select2",className:"form-control input-sm"}),React.createElement(HelpBlock,null,this.getError("voterId"))),React.createElement("div",{className:"col-md-6",style:{paddingLeft:"0"}},React.createElement(FormGroup,{controlId:"formCellphoneNo",validationState:this.getValidationState("cellphoneNo")},React.createElement(ControlLabel,null," CellphoneNo : "),React.createElement("input",{type:"text",placeholder:"Example : 09283182013",value:this.state.form.data.cellphoneNo,className:"input-sm form-control",onChange:this.setFormProp,name:"cellphoneNo"}),React.createElement(HelpBlock,null,this.getError("cellphoneNo")))),React.createElement("div",{className:"col-md-6",style:{paddingRight:"0"}},React.createElement(FormGroup,{controlId:"formVoterGroup",validationState:this.getValidationState("voterGroup")},React.createElement(ControlLabel,null,"Position : "),React.createElement("select",{id:"voter-group-select2",className:"form-control input-sm"},React.createElement("option",{value:""}," ")),React.createElement(HelpBlock,null,this.getError("voterGroup")))),React.createElement(FormGroup,{controlId:"formRemarks",validationState:this.getValidationState("remarks")},React.createElement(ControlLabel,null," Remarks : "),React.createElement("textarea",{rows:"5",value:this.state.form.data.remarks,className:"input-sm form-control",onChange:this.setFormProp,name:"remarks"}),React.createElement(HelpBlock,null,this.getError("remarks"))))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12 text-right"},React.createElement("button",{className:"btn btn-primary btn-sm",disabled:this.isEmpty(this.state.form.data.voterId),type:"submit"}," Submit "),React.createElement("button",{className:"btn btn-default btn-sm",type:"button",onClick:this.props.onHide}," Close "))))))}});window.VoterNetworkRootCreateModal=VoterNetworkRootCreateModal;var Modal=ReactBootstrap.Modal,FormGroup=ReactBootstrap.FormGroup,HelpBlock=ReactBootstrap.HelpBlock,ControlLabel=ReactBootstrap.ControlLabel,FormControl=ReactBootstrap.FormControl,VoterNetworkCreateModal=React.createClass({displayName:"VoterNetworkCreateModal",getInitialState:function(){return{form:{data:{voterId:null,nodeLabel:"",parentId:null,municipalityNo:"",brgyNo:"",cellphoneNo:"",remarks:""},errors:[]},parentNode:null}},getDefaultProps:function(){return{nodeId:null}},componentDidMount:function(){this.loadNode(this.props.nodeId)},initSelect2:function(){var e=this;$("#form-voter-select2").select2({casesentitive:!1,placeholder:"Enter Name...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",dropdownCssClass:"custom-option",ajax:{url:Routing.generate("ajax_select2_groupless_voter"),data:function(t){return{searchText:t.term,electId:e.state.parentNode.electId,proId:e.state.parentNode.proId,provinceCode:e.state.parentNode.provinceCode,municipalityNo:e.state.parentNode.municipalityNo,brgyNo:e.state.parentNode.brgyNo}},processResults:function(e,t){return{results:e.map(function(e){var t="",a=!1,o=1==e.voted_2017?"*":"";return 1==e.in_network?(t=o+e.voter_name+" ("+(e.is_leader?"LEADER":"MEMBER")+") - "+e.precinct_no,a=!0):t=o+e.voter_name+" - "+e.precinct_no,{id:e.voter_id,text:t,disabled:a}})}}}}),$("#voter-group-select2").select2({casesentitive:!1,placeholder:"Enter Group",width:"100%",allowClear:!0,tags:!0,containerCssClass:":all:",createTag:function(e){return{id:e.term,text:e.term,newOption:!0}},ajax:{url:Routing.generate("ajax_select2_voter_group"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.voter_group,text:e.voter_group}})}}}}),$("#form-voter-select2").on("change",function(){e.loadVoter(e.props.proId,$(this).val())}),$("#voter-group-select2").on("change",function(){e.setFieldValue("voterGroup",$(this).val())})},loadNode:function(e){var t=this;t.requestNode=$.ajax({url:Routing.generate("ajax_get_network_node",{nodeId:e}),type:"GET"}).done(function(e){t.setState({parentNode:e}),t.initSelect2()})},loadVoter:function(e,t){var a=this;a.requestVoter=$.ajax({url:Routing.generate("ajax_get_project_voter",{proId:e,voterId:t}),type:"GET"}).done(function(e){var t=a.state.form;t.data.nodeLabel=e.voterName,t.data.nodeOrder=10,t.data.municipalityNo=e.municipalityNo,t.data.brgyNo=e.brgyNo,t.data.voterId=e.voterId,t.data.cellphoneNo=a.isEmpty(e.cellphoneNo)?"":e.cellphoneNo,t.data.voterGroup=e.voterGroup,t.data.remarks=a.isEmpty(e.remarks)?"":e.remarks,$("#voter-group-select2").empty().append($("<option/>").val(e.voterGroup).text(e.voterGroup)).trigger("change"),a.setState({form:t})})},reset:function(){var e=this.state.form;e.data.voterId="",e.data.nodeLabel="",e.data.nodeOrder=1,e.data.cellphoneNo="",e.data.remarks="",e.errors=[],$("#form-voter-select2").empty().trigger("change"),this.setState({form:e})},setFormProp:function(e){var t=this.state.form;t.data[e.target.name]=e.target.value,this.setState({form:t})},setFieldValue:function(e,t){var a=this.state.form;a.data[e]=t,this.setState({form:a})},setErrors:function(e){var t=this.state.form;t.errors=e,this.setState({form:t})},getError:function(e){var t=this.state.form.errors;for(var a in t)if(a==e)return t[e];return null},getValidationState:function(e){return null!=this.getError(e)?"error":""},isEmpty:function(e){return null==e||""==e},submit:function(e){e.preventDefault();var t=this,a=t.state.form.data;a.parentId=t.props.nodeId,console.log("node information"),console.log(a),t.requestNode=$.ajax({url:Routing.generate("ajax_post_network_node"),type:"POST",data:a}).done(function(e){t.reset(),t.props.onSuccess(),t.props.notify("Member branch has been added.","teal")}).fail(function(e){"401"==e.status?t.props.notify("You dont have the permission to update this record.","ruby"):t.props.notify("Form Validation Failed.","ruby"),t.setErrors(e.responseJSON)})},render:function(){var e=this;e.state.form.data;return React.createElement(Modal,{keyboard:!1,enforceFocus:!1,dialogClassName:"modal-custom-40",backdrop:"static",show:this.props.show,onHide:this.props.onHide},React.createElement(Modal.Header,{className:"modal-header bg-blue-dark font-white",closeButton:!0},React.createElement(Modal.Title,null,"Node Form")),React.createElement(Modal.Body,{bsClass:"modal-body overflow-auto"},React.createElement("form",{id:"voter-node-form",onSubmit:this.submit},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12"},React.createElement(FormGroup,{controlId:"formVoterId",validationState:this.getValidationState("voterId")},React.createElement(ControlLabel,null," Voter Name : "),React.createElement("select",{id:"form-voter-select2",className:"form-control input-sm"}),React.createElement(HelpBlock,null,this.getError("voterId"))),React.createElement("div",{className:"col-md-6",style:{paddingLeft:"0"}},React.createElement(FormGroup,{controlId:"formCellphoneNo",validationState:this.getValidationState("cellphoneNo")},React.createElement(ControlLabel,null," CellphoneNo : "),React.createElement("input",{type:"text",placeholder:"Example : 09283182013",value:this.state.form.data.cellphoneNo,className:"input-sm form-control",onChange:this.setFormProp,name:"cellphoneNo"}),React.createElement(HelpBlock,null,this.getError("cellphoneNo")))),React.createElement("div",{className:"col-md-6",style:{paddingRight:"0"}},React.createElement(FormGroup,{controlId:"formVoterGroup",validationState:this.getValidationState("voterGroup")},React.createElement(ControlLabel,null,"Position : "),React.createElement("select",{id:"voter-group-select2",className:"form-control input-sm"},React.createElement("option",{value:""}," ")),React.createElement(HelpBlock,null,this.getError("voterGroup")))),React.createElement(FormGroup,{controlId:"formRemarks",validationState:this.getValidationState("remarks")},React.createElement(ControlLabel,null," Remarks : "),React.createElement("textarea",{rows:"5",value:this.state.form.data.remarks,className:"input-sm form-control",onChange:this.setFormProp,name:"remarks"}),React.createElement(HelpBlock,null,this.getError("remarks"))))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12 text-right"},React.createElement("button",{className:"btn btn-primary btn-sm",disabled:this.isEmpty(this.state.form.data.voterId),type:"submit"}," Submit "),React.createElement("button",{className:"btn btn-default btn-sm",type:"button",onClick:this.props.onHide}," Close "))))))}});window.VoterNetworkCreateModal=VoterNetworkCreateModal;var Modal=ReactBootstrap.Modal,FormGroup=ReactBootstrap.FormGroup,HelpBlock=ReactBootstrap.HelpBlock,ControlLabel=ReactBootstrap.ControlLabel,FormControl=ReactBootstrap.FormControl,VoterNetworkEditModal=React.createClass({displayName:"VoterNetworkEditModal",getInitialState:function(){return{form:{data:{nodeId:null,voterId:null,nodeLabel:"",parentId:null,municipalityNo:"",brgyNo:"",cellphoneNo:"",remarks:""},errors:[]},parentNode:{municipalityNo:null,brgyNo:null},member:null}},getDefaultProps:function(){return{nodeId:null}},componentDidMount:function(){this.initSelect2(),this.loadNode(this.props.nodeId)},initUploader:function(){var e=this;console.log("initializing uploader"),$("#network-photo-upload").fileupload({dataType:"json",done:function(t,a){console.log("image has been uploaded"),$.each(a.result.files,function(e,t){$("<p/>").text(t.name).appendTo(document.body)}),e.loadVoter(e.props.proId,e.state.form.data.voterId)},progressall:function(e,t){console.log("uploading");parseInt(t.loaded/t.total*100,10)}})},initSelect2:function(){var e=this;$("#form-voter-select2").select2({casesentitive:!1,placeholder:"Enter Name...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",dropdownCssClass:"custom-option",ajax:{url:Routing.generate("ajax_select2_groupless_voter"),data:function(t){return{searchText:t.term,provinceCode:e.state.parentNode.provinceCode,municipalityNo:e.state.parentNode.municipalityNo,brgyNo:e.state.parentNode.brgyNo}},processResults:function(e,t){return{results:e.map(function(e){var t="",a=!1,o=1==e.voted_2017?"*":"";return 1==e.in_network?(t=o+e.voter_name+" ("+(e.is_leader?"LEADER":"MEMBER")+") - "+e.precinct_no,a=!0):t=o+e.voter_name+" - "+e.precinct_no,{id:e.voter_id,text:t,disabled:a}})}}}}),$("#voter-group-select2").select2({casesentitive:!1,placeholder:"Enter Group",width:"100%",allowClear:!0,tags:!0,containerCssClass:":all:",createTag:function(e){return{id:e.term,text:e.term,newOption:!0}},ajax:{url:Routing.generate("ajax_select2_voter_group"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.voter_group,text:e.voter_group}})}}}}),$("#voter-group-select2").on("change",function(){e.setFieldValue("voterGroup",$(this).val())})},loadNode:function(e){var t=this;t.requestNode=$.ajax({url:Routing.generate("ajax_get_network_node",{nodeId:e}),type:"GET"}).done(function(e){t.setState({parentNode:e},t.loadVoter.bind(t,e.proId,e.voterId))})},loadVoter:function(e,t){var a=this;console.log("loading voter"),a.requestVoter=$.ajax({url:Routing.generate("ajax_get_project_voter",{proId:e,voterId:t}),type:"GET"}).done(function(e){var t=a.state.form;t.data.nodeLabel=e.voterName,t.data.nodeOrder=10,t.data.municipalityNo=e.municipalityNo,t.data.brgyNo=e.brgyNo,t.data.voterId=e.voterId,t.data.voterGroup=e.voterGroup,t.data.cellphoneNo=a.isEmpty(e.cellphoneNo)?"":e.cellphoneNo,t.data.remarks=a.isEmpty(e.remarks)?"":e.remarks,$("#form-voter-select2").empty().append($("<option/>").val(e.voterId).text(e.voterName)).trigger("change"),$("#voter-group-select2").empty().append($("<option/>").val(e.voterGroup).text(e.voterGroup)).trigger("change"),$("#form-voter-select2").select2("enable",!1),a.setState({form:t,member:e},a.initUploader)})},reset:function(){var e=this.state.form;e.data.voterId="",e.data.nodeLabel="",e.data.nodeOrder=1,e.data.cellphoneNo="",e.data.remarks="",e.errors=[],$("#form-voter-select2").empty().trigger("change"),this.setState({form:e})},setFormProp:function(e){var t=this.state.form;t.data[e.target.name]=e.target.value,this.setState({form:t})},setFieldValue:function(e,t){var a=this.state.form;a.data[e]=t,this.setState({form:a})},setErrors:function(e){var t=this.state.form;t.errors=e,this.setState({form:t})},getError:function(e){var t=this.state.form.errors;for(var a in t)if(a==e)return t[e];return null},getValidationState:function(e){return null!=this.getError(e)?"error":""},isEmpty:function(e){return null==e||""==e},submit:function(e){e.preventDefault();var t=this,a=t.state.form.data;t.requestNode=$.ajax({url:Routing.generate("ajax_patch_network_node",{nodeId:t.props.nodeId}),type:"PATCH",data:a}).done(function(e){t.props.onHide(),t.props.notify("Record has been successfully updated.","teal"),t.props.onSuccess()}).fail(function(e){"401"==e.status?t.props.notify("You dont have the permission to update this record.","ruby"):t.props.notify("Form Validation Failed.","ruby"),t.setErrors(e.responseJSON)})},generateIdNo:function(){var e=this;e.requestVoter=$.ajax({url:Routing.generate("ajax_get_project_voter_generate_id_no",{voterId:e.state.form.data.voterId,proId:e.props.proId}),type:"GET"}).done(function(t){alert("ID NO has been created : "+t.proIdCode),e.loadVoter(e.props.proId,e.state.form.data.voterId)})},resetId:function(){var e=this;e.requestVoter=$.ajax({url:Routing.generate("ajax_get_project_voter_reset_id",{voterId:e.state.form.data.voterId,proId:e.props.proId}),type:"GET"}).done(function(t){alert("You can now re-print this member ID"),e.loadVoter(e.props.proId,e.state.form.data.voterId)})},render:function(){var e=this;e.state.form.data;if(null!=this.state.member)var t=null!=this.state.member.proIdCode?this.state.member.proIdCode.replace("KFC",""):"no_id",a="http://"+window.hostIp+"/voter-2018/web/app.php/voter/photo/"+this.props.proId+"_"+t+"?"+(new Date).getTime();return React.createElement(Modal,{keyboard:!1,enforceFocus:!1,bsSize:"lg",backdrop:"static",show:this.props.show,onHide:this.props.onHide},React.createElement(Modal.Header,{className:"modal-header bg-blue-dark font-white",closeButton:!0},React.createElement(Modal.Title,null,"Node Form")),React.createElement(Modal.Body,{bsClass:"modal-body overflow-auto"},React.createElement("form",{id:"voter-node-form",onSubmit:this.submit},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-3"},null!=this.state.member&&React.createElement("div",{className:"row voter-view-header"},React.createElement("div",{className:"col-md-12"},React.createElement("div",null,React.createElement("a",{href:a,"data-lightbox":"Profile Photo","data-title":"Profile Photo"},React.createElement("img",{src:a,className:"img-responsive",alt:""}))),React.createElement("div",{className:"profile-userbuttons",style:{marginTop:"10px"}},React.createElement("span",{className:"btn col-md-12 green btn-sm fileinput-button "},React.createElement("span",null," Change Photo"),React.createElement("input",{id:"network-photo-upload",type:"file",name:"files[]","data-url":Routing.generate("ajax_upload_project_voter_photo",{proId:this.props.proId,voterId:this.state.form.data.voterId}),multiple:!1}))),this.isEmpty(this.state.member.proIdCode)&&React.createElement("div",null,React.createElement("button",{className:"btn btn-primary btn-sm col-md-12",type:"button",onClick:this.generateIdNo,style:{marginTop:"10px"}},"Generate ID No")),this.state.hasId&&React.createElement("div",null,React.createElement("button",{className:"btn btn-info btn-sm col-md-12",type:"button",onClick:this.resetId,style:{marginTop:"10px"}},"Reprint ID")),React.createElement("br",null),React.createElement("div",{style:{marginTop:"10px"}},React.createElement("div",null,React.createElement("strong",null,"Birthdate : ")," ",""==this.state.member.birthdate?"- - - -":this.state.member.birthdate," "),React.createElement("div",null,React.createElement("strong",null,"Municipality :")," ",this.state.member.municipalityName," "),React.createElement("div",null,React.createElement("strong",null,"Barangay :")," ",this.state.member.barangayName," "),React.createElement("div",null,React.createElement("strong",null,"Precinct No :")," ",this.state.member.precinctNo," "),React.createElement("div",null,React.createElement("strong",null,"Cellphone No :")," ",this.state.member.cellphoneNo," "),React.createElement("div",null,React.createElement("strong",null,"Position : ")," ",""==this.state.member.voterGroup?"- - - -":this.state.member.voterGroup," "),React.createElement("div",null,React.createElement("strong",null,"ID No : ")," ",""==this.state.member.proIdCode?"- - - -":this.state.member.proIdCode," ")))),null==this.state.member&&React.createElement("div",{className:"row voter-view-header"},React.createElement("div",{className:"col-md-12"},React.createElement("h4",{className:"text-center"},"Member not found...")))),React.createElement("div",{className:"col-md-9"},React.createElement(FormGroup,{controlId:"formVoterId",validationState:this.getValidationState("voterId")},React.createElement(ControlLabel,null," Voter Name : "),React.createElement("select",{id:"form-voter-select2",className:"form-control input-sm"}),React.createElement(HelpBlock,null,this.getError("voterId"))),React.createElement("div",{className:"col-md-6",style:{paddingLeft:"0"}},React.createElement(FormGroup,{controlId:"formCellphoneNo",validationState:this.getValidationState("cellphoneNo")},React.createElement(ControlLabel,null," CellphoneNo : "),React.createElement("input",{type:"text",placeholder:"Example : 09283182013",value:this.state.form.data.cellphoneNo,className:"input-sm form-control",onChange:this.setFormProp,name:"cellphoneNo"}),React.createElement(HelpBlock,null,this.getError("cellphoneNo")))),React.createElement("div",{className:"col-md-6",style:{paddingRight:"0"}},React.createElement(FormGroup,{controlId:"formVoterGroup",validationState:this.getValidationState("voterGroup")},React.createElement(ControlLabel,null,"Position : "),React.createElement("select",{id:"voter-group-select2",className:"form-control input-sm"},React.createElement("option",{value:""}," ")),React.createElement(HelpBlock,null,this.getError("voterGroup")))),React.createElement(FormGroup,{controlId:"formRemarks",validationState:this.getValidationState("remarks")},React.createElement(ControlLabel,null," Remarks : "),React.createElement("textarea",{rows:"5",value:this.state.form.data.remarks,className:"input-sm form-control",onChange:this.setFormProp,name:"remarks"}),React.createElement(HelpBlock,null,this.getError("remarks"))))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12 text-right"},React.createElement("button",{className:"btn btn-primary btn-sm",disabled:this.isEmpty(this.state.form.data.voterId),type:"submit"}," Submit "),React.createElement("button",{className:"btn btn-default btn-sm",type:"button",onClick:this.props.onHide}," Close "))))))}});window.VoterNetworkEditModal=VoterNetworkEditModal;var FormGroup=ReactBootstrap.FormGroup,HelpBlock=ReactBootstrap.HelpBlock,ControlLabel=ReactBootstrap.ControlLabel,FormControl=ReactBootstrap.FormControl,VoterNetworkComponent=React.createClass({displayName:"VoterNetworkComponent",getInitialState:function(){return{electId:null,proId:null,provinceCode:null,municipalityNo:null,brgyNo:null,barangay:{total_voter:0,total_recruits:0,percentage:0},searchTimer:null,delay:1e3,searchText:"",target:null,orderBy:"entryNo",nodeLevel:1,showRootCreateModal:!1,showNodeCreateModal:!1,showNodeEditModal:!1,items:[],loading:!1,activeNode:null,activeRoot:null,user:null}},notify:function(e,t){$.notific8("zindex",11500),$.notific8(e,{heading:"System Message",color:t,life:5e3,verticalEdge:"right",horizontalEdge:"top"})},render:function(){var e=this;return React.createElement("div",{className:"portlet light portlet-fit bordered"},React.createElement("div",{className:"portlet-body"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-5"},this.state.showRootCreateModal&&React.createElement(VoterNetworkRootCreateModal,{show:this.state.showRootCreateModal,onHide:this.closeRootCreateModal,notify:this.notify,onSuccess:this.onSuccessRootCreate,electId:this.state.electId,provinceCode:this.state.provinceCode,proId:this.state.proId,municipalityNo:this.state.municipalityNo,brgyNo:this.state.brgyNo}),this.state.showNodeCreateModal&&React.createElement(VoterNetworkCreateModal,{show:this.state.showNodeCreateModal,onHide:this.closeCreateModal,onSuccess:this.onSuccessMemberCreate,nodeId:this.state.target,notify:this.notify,electId:this.state.electId,proId:this.state.proId}),this.state.showNodeEditModal&&React.createElement(VoterNetworkEditModal,{show:this.state.showNodeEditModal,onHide:this.closeEditModal,nodeId:this.state.target,notify:this.notify,onSuccess:this.onSuccessMemberEdit,electId:this.state.electId,proId:this.state.proId}),React.createElement("form",null,React.createElement(FormGroup,{controlId:"formElection"},React.createElement(ControlLabel,null," Election : "),React.createElement("select",{id:"form-election-select2",className:"form-control input-sm"})),React.createElement(FormGroup,{controlId:"formProjectCode"},React.createElement(ControlLabel,null," Project : "),React.createElement("select",{id:"form-project-select2",className:"form-control input-sm"})),React.createElement(FormGroup,{controlId:"formProvinceCode"},React.createElement(ControlLabel,null," Province : "),React.createElement("select",{id:"form-province-select2",className:"form-control input-sm"})),React.createElement(FormGroup,{controlId:"formMunicipalityNo"},React.createElement(ControlLabel,null," Municipality : "),React.createElement("select",{id:"form-municipality-select2",className:"form-control input-sm"})),React.createElement(FormGroup,{controlId:"formBarangayNo"},React.createElement(ControlLabel,null," Barangay : "),React.createElement("select",{id:"form-barangay-select2",className:"form-control input-sm"}))),!this.state.loading&&React.createElement("button",{type:"button",className:"btn btn-primary btn-sm",style:{width:"100%"},onClick:this.apply},"Apply "),this.state.loading&&React.createElement("button",{type:"button",disabled:!0,className:"btn red-sunglo btn-sm",style:{width:"100%"}}," Loading ",React.createElement("i",{className:"fa fa-spinner fa-pulse fa-1x fa-fw"})),React.createElement("div",{style:{marginTop:"20px"}},React.createElement("div",{className:"row",style:{marginBottom:"10px"}},React.createElement("div",{className:"col-md-6"},React.createElement("select",{name:"nodeLevel",className:"form-control input-sm",value:this.state.nodeLevel,onChange:this.setNodeLevel},React.createElement("option",{value:"1"},"Level 1"),React.createElement("option",{value:"2"},"Level 2"),React.createElement("option",{value:"3"},"Level 3"),React.createElement("option",{value:"4"},"Level 4"),React.createElement("option",{value:"5"},"Level 5"),React.createElement("option",{value:"6"},"Level 6"))),React.createElement("div",{className:"col-md-6"},React.createElement("select",{name:"orderBy",className:"form-control input-sm",value:this.state.orderBy,onChange:this.setOrderBy},React.createElement("option",{value:"entryNo"},"Entry Date"),React.createElement("option",{value:"name"},"Name")))),React.createElement("input",{className:"form-control input-sm",type:"text",placeholder:"Search group leader...",onChange:this.setSearchText}),React.createElement("ul",{style:{listStyleType:"none",padding:"5px",backgroundColor:"#E6E6E6",height:"180px",width:"100%",overflow:"scroll"}},this.state.items.map(function(t,a){var o=t.node_id==e.state.activeNode?"bg-blue-dark font-white":"";return React.createElement("li",{className:o,style:{padding:"5px",cursor:"pointer",fontSize:"12px"},key:"item"+t.node_id,value:t.node_id,onClick:e.setActiveNode.bind(e,t.root_node,t.node_id)},++a,". ",1==t.voted_2017?"*":"",t.node_label," - ",t.precinct_no," (",t.voter_group,")",React.createElement("i",{className:"fa fa-trash font-red",onClick:e.removeRootNode.bind(e,t.node_id)}))}),0==this.state.items.length&&!this.state.loading&&React.createElement("li",{style:{padding:"5px"},className:"text-center bg-red-sunglo font-white"},"Opps! Your leader list is empty..."))),React.createElement("button",{type:"button",className:"btn btn-primary btn-sm",onClick:this.openRootCreateModal,disabled:e.isEmpty(this.state.municipalityNo),style:{width:"100%"}},"Add Leader")),React.createElement("div",{className:"col-md-7"},React.createElement("div",{className:"col-md-4"},React.createElement("p",null,React.createElement("strong",null,"Hierarchy View"))),React.createElement("div",{className:"col-md-8 text-right"},React.createElement("div",{className:"bold"},"Registered : ",React.createElement("span",{className:"font-red-sunglo",style:{marginRight:"5px"}},this.state.barangay.total_voter),"Recruited : ",React.createElement("span",{className:"font-red-sunglo",style:{marginRight:"5px"}},this.state.barangay.total_recruits),"Percentage : ",React.createElement("span",{className:"font-red-sunglo"},parseFloat(this.state.barangay.percentage).toFixed(2)," %"))),React.createElement("div",{className:"col-md-12"},React.createElement("div",{id:"sample-tree"}))))))},componentDidMount:function(){this.catchHttpErrors(),this.loadUser(window.userId),this.initSelect2(),this.initNetwork()},catchHttpErrors:function(){var e=this;$(document).ajaxError(function(t,a,o){switch(a.status){case 400:e.notify("Form validation failed.","ruby");break;case 401:case 403:e.notify("Action denied.You are not allowed to perform this action.","ruby");break;case 500:e.notify("Opps. Something went wrong in the server. Please inform the system administrator.","ruby")}})},loadUser:function(e){var t=this;t.requestUser=$.ajax({url:Routing.generate("ajax_get_user",{id:e}),type:"GET"}).done(function(e){t.setState({user:e},t.reinitSelect2)})},initNetwork:function(){$.jstree.defaults.core.themes.variant="large";var e=this;$("#sample-tree").jstree({core:{animation:0,check_callback:!0,themes:{stripes:!0},data:{cache:!1,dataType:"json",url:function(t){return Routing.generate("ajax_get_network_nodes",{provinceCode:e.state.provinceCode,municipalityNo:e.state.municipalityNo,brgyNo:e.state.brgyNo,rootId:e.state.activeRoot,nodeId:e.state.activeNode})},data:function(e){return{id:e.id}}}},plugins:["contextmenu","wholerow"],contextmenu:{select_node:!1,items:e.reportMenu}})},refreshTree:function(){$("#sample-tree").jstree(!0).refresh()},setActiveNode:function(e,t){this.setState({activeNode:t,activeRoot:t},this.refreshTree)},clearItems:function(){this.setState({activeNode:null,items:[]})},loadItems:function(){var e=this;e.requestItems=$.ajax({url:Routing.generate("ajax_get_root_nodes",{electId:e.state.electId,proId:e.state.proId,provinceCode:e.state.provinceCode,municipalityNo:e.state.municipalityNo,brgyNo:e.state.brgyNo,searchText:e.state.searchText,orderBy:e.state.orderBy,nodeLevel:e.state.nodeLevel}),type:"GET"}).done(function(t){e.setState({items:t})}).always(function(){e.setState({loading:!1})}),e.setState({loading:!0})},openRootCreateModal:function(){this.setState({showRootCreateModal:!0}),this.loadItems()},closeRootCreateModal:function(e){this.setState({showRootCreateModal:!1})},onSuccessRootCreate:function(e){var t=this;t.loadItems(),t.loadBarangay(),t.setState({showNodeCreateModal:!1,activeRoot:null}),setTimeout(function(){t.setState({showRootCreateModal:!1,activeRoot:e},t.refreshTree)},500)},onSuccessMemberCreate:function(){this.loadItems(),this.loadBarangay(),this.refreshTree()},onSuccessMemberEdit:function(){this.loadItems(),this.loadBarangay(),this.refreshTree()},closeCreateModal:function(){this.setState({target:null,showNodeCreateModal:!1})},openCreateModal:function(e){this.setState({target:e,showNodeCreateModal:!0})},openEditModal:function(e){this.setState({target:e,showNodeEditModal:!0})},closeEditModal:function(){this.setState({target:null,showNodeEditModal:!1})},apply:function(){var e=this.state.municipalityNo
;this.state.brgyNo;this.isEmpty(e)?alert("Please select a municipaity and barangay."):(this.loadItems(),this.loadBarangay())},removeRootNode:function(e){var t=this;confirm("Are you sure you want to remove this item?")&&(t.requestDelete=$.ajax({url:Routing.generate("ajax_delete_network_node",{nodeId:e}),type:"DELETE"}).done(function(e){t.notify("Recruit/Recruits has been removed.","teal"),t.loadItems(),t.loadBarangay(),t.setState({activeNode:null},t.refreshTree)}).fail(function(e){"401"==e.status?t.notify("You dont have the permission to update this record.","ruby"):t.notify("Form Validation Failed.","ruby")}))},removeNode:function(e){var t=this;confirm("Are you sure you want to remove this item?")&&(t.requestDelete=$.ajax({url:Routing.generate("ajax_delete_network_node",{nodeId:e.id}),type:"DELETE"}).done(function(e){t.notify("Member has been removed.","teal"),t.loadItems(),t.loadBarangay(),t.refreshTree()}).fail(function(e){"401"==e.status?t.notify("You dont have the permission to update this record.","ruby"):t.notify("Form Validation Failed.","ruby")}))},initSelect2:function(){var e=this;$("#form-election-select2").select2({casesentitive:!1,placeholder:"Select election....",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_elections"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.elect_id,text:e.elect_name}})}}}}),$("#form-province-select2").select2({casesentitive:!1,placeholder:"Enter Name...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_province"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.province_code,text:e.name}})}}}}),$("#form-project-select2").select2({casesentitive:!1,placeholder:"Select project....",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_projects"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.pro_id,text:e.pro_name}})}}}}),$("#form-municipality-select2").select2({casesentitive:!1,placeholder:"Enter Name...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_municipality_strict"),data:function(e){return{searchText:e.term,provinceCode:$("#form-province-select2").val()}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.municipality_no,text:e.name}})}}}}),$("#form-barangay-select2").select2({casesentitive:!1,placeholder:"Enter name...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_barangay_strict"),data:function(e){return{searchText:e.term,provinceCode:$("#form-province-select2").val(),municipalityNo:$("#form-municipality-select2").val()}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.brgy_no,text:e.name}})}}}}),$("#form-election-select2").on("change",function(){e.setState({electId:$(this).val()})}),$("#form-project-select2").on("change",function(){e.setState({proId:$(this).val()})}),$("#form-province-select2").on("change",function(){$("#form-municipality-select2").empty().trigger("change"),$("#form-barangay-select2").empty().trigger("change"),e.setState({provinceCode:$(this).val()})}),$("#form-municipality-select2").on("change",function(){$("#form-barangay-select2").empty().trigger("change"),e.setState({municipalityNo:$(this).val()})}),$("#form-barangay-select2").on("change",function(){e.setState({brgyNo:$(this).val()})})},reinitSelect2:function(){var e=this;if(!e.isEmpty(e.state.user.project)){var t=e.state.user.project.provinceCode;e.requestProvince=$.ajax({url:Routing.generate("ajax_get_province",{provinceCode:t}),type:"GET"}).done(function(e){$("#form-province-select2").empty().append($("<option/>").val(e.province_code).text(e.name)).trigger("change")}),e.requestProject=$.ajax({url:Routing.generate("ajax_get_project",{proId:e.state.user.project.proId}),type:"GET"}).done(function(e){$("#form-project-select2").empty().append($("<option/>").val(e.proId).text(e.proName)).trigger("change")})}e.requestActiveElection=$.ajax({url:Routing.generate("ajax_get_active_election"),type:"GET"}).done(function(e){$("#form-election-select2").empty().append($("<option/>").val(e.electId).text(e.electName)).trigger("change")}),e.state.user.isAdmin||$("#form-province-select2").attr("disabled","disabled")},loadBarangay:function(){var e=this;e.requestItems=$.ajax({url:Routing.generate("ajax_get_baranagy_full",{provinceCode:e.state.provinceCode,municipalityNo:e.state.municipalityNo,brgyNo:e.state.brgyNo}),type:"GET"}).done(function(t){e.setState({barangay:t})})},isEmpty:function(e){return null==e||""==e||"undefined"==e},reportMenu:function(e){var t=this;return{createItem:{label:"Add Member",action:function(a){t.openCreateModal(e.id)},_class:"class"},editItem:{label:"Edit",action:function(a){t.openEditModal(e.id)},_class:"class"},deleteItem:{label:"Remove",action:function(a){t.removeNode(e)}}}},setSearchText:function(e){var t=this,a=null;null==t.state.searchTimer?(a=setTimeout(function(){t.setState({searchTimer:null},t.loadItems)},t.state.delay),t.setState({searchTimer:a,searchText:e.target.value})):t.setState({searchTimer:a,searchText:e.target.value})},setOrderBy:function(e){this.setState({orderBy:e.target.value},this.loadItems)},setNodeLevel:function(e){this.setState({nodeLevel:e.target.value},this.loadItems)}});setTimeout(function(){ReactDOM.render(React.createElement(VoterNetworkComponent,null),document.getElementById("voter-container"))},500);