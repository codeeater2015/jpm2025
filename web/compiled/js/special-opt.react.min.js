var Modal=ReactBootstrap.Modal,FormGroup=ReactBootstrap.FormGroup,HelpBlock=ReactBootstrap.HelpBlock,ControlLabel=ReactBootstrap.ControlLabel,FormControl=ReactBootstrap.FormControl,SpecialOptCreateLeaderModal=React.createClass({displayName:"SpecialOptCreateLeaderModal",getInitialState:function(){return{form:{data:{municipalityNo:null,brgyNo:null,proVoterId:null,voterId:null,cellphone:"",voterGroup:"",optType:"REGULAR",is1:1,is2:0,is3:0,is4:0,is5:0,is6:0,is7:0,is8:0,is9:1,is10:0},errors:[]}}},componentDidMount:function(){this.initSelect2()},initSelect2:function(){var e=this;$("#new_leader_form #municipality_select2").select2({casesentitive:!1,placeholder:"Select City/Municipality",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_municipality"),data:function(t){return{searchText:t.term,provinceCode:e.props.provinceCode}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.municipality_no,text:e.name}})}}}}),$("#new_leader_form #barangay_select2").select2({casesentitive:!1,placeholder:"Select Barangay",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_barangay"),data:function(e){return{searchText:e.term,municipalityNo:$("#new_leader_form #municipality_select2").val(),provinceCode:53}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.brgy_no,text:e.name}})}}}}),$("#new_leader_form #voter-recruit-select2").select2({casesentitive:!1,placeholder:"Enter Name...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",dropdownCssClass:"custom-option",ajax:{url:Routing.generate("ajax_select2_project_voters_strict"),data:function(t){return{searchText:t.term,electId:e.props.electId,proId:e.props.proId,provinceCode:e.props.provinceCode,municipalityNo:$("#new_leader_form #municipality_select2").val()}},processResults:function(e,t){return{results:e.map(function(e){var t=e.voter_name+" - "+e.precinct_no+" ( "+e.municipality_name+", "+e.barangay_name+" )";return{id:e.voter_id,text:t}})}}}}),$("#new_leader_form #voter-group-select2").select2({casesentitive:!1,placeholder:"Enter Group",width:"100%",allowClear:!0,tags:!0,containerCssClass:":all:",createTag:function(e){return{id:e.term,text:e.term,newOption:!0}},ajax:{url:Routing.generate("ajax_select2_voter_group"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.voter_group,text:e.voter_group}})}}}}),$("#new_leader_form #municipality_select2").on("change",function(){e.setFieldValue("municipalityNo",$(this).val())}),$("#new_leader_form #barangay_select2").on("change",function(){e.setFieldValue("brgyNo",$(this).val())}),$("#new_leader_form #voter-recruit-select2").on("change",function(){e.loadVoter(e.props.proId,$(this).val())}),$("#new_leader_form #voter-group-select2").on("change",function(){e.setFieldValue("voterGroup",$(this).val())})},loadVoter:function(e,t){var a=this;a.requestVoter=$.ajax({url:Routing.generate("ajax_get_project_voter",{proId:e,voterId:t}),type:"GET"}).done(function(e){var t=a.state.form;t.data.voterId=e.voterId,t.data.proVoterId=e.proVoterId,t.data.proIdCode=e.proIdCode,t.data.cellphone=a.isEmpty(e.cellphoneNo)?"":e.cellphoneNo,t.data.precinctNo=e.precinctNo,t.data.assignedPrecinct=a.isEmpty(e.assignedPrecinct)?e.precinctNo:e.assignedPrecinct,t.data.voterGroup=a.isEmpty(e.voterGroup)?"KFC":e.voterGroup,t.data.remarks=a.isEmpty(e.remarks)?"":e.remarks,t.data.is3=e.is3,t.data.is4=e.is4,t.data.is5=e.is5,t.data.is6=e.is6,t.data.is7=e.is7,t.data.is8=e.is8,t.data.is10=e.is10,$("#voter-group-select2").empty().append($("<option/>").val(t.data.voterGroup).text(t.data.voterGroup)).trigger("change"),a.setState({form:t},a.initUploader)})},setFormProp:function(e){var t=this.state.form;t.data[e.target.name]=e.target.value,this.setState({form:t})},setFieldValue:function(e,t){var a=this.state.form;a.data[e]=t,this.setState({form:a})},setOptType:function(e){var t=this.state.form,a=e.target.value;switch(t.data.optType=a,a){case"REGULAR":t.data.is9=1,t.data.is2=0;break;case"PULAHAN":t.data.is2=1,t.data.is9=0}this.setState({form:t})},handleCheckbox:function(e){var t=this.state.form;t.data[e.target.name]=e.target.checked?1:0,this.setState({form:t})},setErrors:function(e){var t=this.state.form;t.errors=e,this.setState({form:t})},getError:function(e){var t=this.state.form.errors;for(var a in t)if(a==e)return t[e];return null},getValidationState:function(e){return null!=this.getError(e)?"error":""},isEmpty:function(e){return null==e||""==e},submit:function(e){e.preventDefault();var t=this,a=t.state.form.data;a.proId=t.props.proId,a.electId=t.props.electId,a.provinceCode=t.props.provinceCode,t.requestPost=$.ajax({url:Routing.generate("ajax_post_special_opt_header"),data:a,type:"POST"}).done(function(e){t.props.onSuccess(),t.props.onHide()}).fail(function(e){t.setErrors(e.responseJSON)})},render:function(){var e=window.imgUrl+this.props.proId+"_"+this.state.form.data.proIdCode+"?"+(new Date).getTime();return React.createElement(Modal,{enforceFocus:!1,bsSize:"lg",backdrop:"static",show:this.props.show,onHide:this.props.onHide},React.createElement(Modal.Header,{closeButton:!0},React.createElement(Modal.Title,null,"New Special Operation Leader")),React.createElement(Modal.Body,{bsClass:"modal-body overflow-auto"},React.createElement("form",{id:"new_leader_form",onSubmit:this.submit},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12"},React.createElement("div",{className:"col-md-4"},React.createElement(FormGroup,{controlId:"formMunicipalityNo",validationState:this.getValidationState("municipalityNo")},React.createElement(ControlLabel,null," Municipality : "),React.createElement("select",{id:"municipality_select2",className:"form-control form-filter input-sm",name:"municipalityNo"}),React.createElement(HelpBlock,null,this.getError("municipalityNo")))),React.createElement("div",{className:"col-md-3"},React.createElement(FormGroup,{controlId:"formBrgyNo",validationState:this.getValidationState("brgyNo")},React.createElement(ControlLabel,null," Barangay : "),React.createElement("select",{id:"barangay_select2",className:"form-control form-filter input-sm",name:"brgyNo"}),React.createElement(HelpBlock,null,this.getError("brgyNo")))),React.createElement("div",{className:"col-md-12"},React.createElement(FormGroup,{controlId:"formVoterId",validationState:this.getValidationState("voterId")},React.createElement(ControlLabel,null," Voter Name : "),React.createElement("select",{id:"voter-recruit-select2",className:"form-control input-sm"}),React.createElement(HelpBlock,null,this.getError("voterId")))),React.createElement("div",{className:"col-md-3"},React.createElement("img",{src:e,className:"img-responsive",alt:""})),React.createElement("div",{className:"col-md-9"},React.createElement("div",{className:"col-md-4"},React.createElement(FormGroup,{controlId:"formCellphone",validationState:this.getValidationState("cellphone")},React.createElement(ControlLabel,null," CellphoneNo : "),React.createElement("input",{type:"text",placeholder:"Example : 09283182013",value:this.state.form.data.cellphone,className:"input-sm form-control",onChange:this.setFormProp,name:"cellphone"}),React.createElement(HelpBlock,null,this.getError("cellphone")))),React.createElement("div",{className:"col-md-3"},React.createElement(FormGroup,{controlId:"formVoterGroup",validationState:this.getValidationState("voterGroup")},React.createElement(ControlLabel,null,"Position : "),React.createElement("select",{id:"voter-group-select2",className:"form-control input-sm"},React.createElement("option",{value:""}," ")),React.createElement(HelpBlock,null,this.getError("voterGroup")))),React.createElement("div",{className:"col-md-4"},React.createElement(FormGroup,{controlId:"formOptType",validationState:this.getValidationState("optType")},React.createElement(ControlLabel,null,"Type : "),React.createElement("select",{name:"optType",onChange:this.setOptType,value:this.state.form.data.optType,className:"form-control input-sm"},React.createElement("option",{value:"REGULAR"},"Regular"),React.createElement("option",{value:"PULAHAN"},"Pulahan")),React.createElement(HelpBlock,null,this.getError("optType")))),React.createElement("div",{className:"clearfix"}),React.createElement("div",{className:"col-md-2"},React.createElement("label",{className:"mt-checkbox status-checkbox"},"1",React.createElement("input",{type:"checkbox",checked:1==this.state.form.data.is1,onChange:this.handleCheckbox,name:"is1"}),React.createElement("span",null))),React.createElement("div",{className:"col-md-2"},React.createElement("label",{className:"mt-checkbox status-checkbox"},"2",React.createElement("input",{type:"checkbox",checked:1==this.state.form.data.is2,onChange:this.handleCheckbox,name:"is2"}),React.createElement("span",null))),React.createElement("div",{className:"col-md-2"},React.createElement("label",{className:"mt-checkbox status-checkbox"},"3",React.createElement("input",{type:"checkbox",checked:1==this.state.form.data.is3,onChange:this.handleCheckbox,name:"is3"}),React.createElement("span",null))),React.createElement("div",{className:"col-md-2"},React.createElement("label",{className:"mt-checkbox status-checkbox"},"4",React.createElement("input",{type:"checkbox",checked:1==this.state.form.data.is4,onChange:this.handleCheckbox,name:"is4"}),React.createElement("span",null))),React.createElement("div",{className:"col-md-2"},React.createElement("label",{className:"mt-checkbox status-checkbox"},"5",React.createElement("input",{type:"checkbox",checked:1==this.state.form.data.is5,onChange:this.handleCheckbox,name:"is5"}),React.createElement("span",null))),React.createElement("div",{className:"clearfix"}),React.createElement("div",{className:"col-md-2"},React.createElement("label",{className:"mt-checkbox status-checkbox"},"6",React.createElement("input",{type:"checkbox",checked:1==this.state.form.data.is6,onChange:this.handleCheckbox,name:"is6"}),React.createElement("span",null))),React.createElement("div",{className:"col-md-2"},React.createElement("label",{className:"mt-checkbox status-checkbox"},"7",React.createElement("input",{type:"checkbox",checked:1==this.state.form.data.is7,onChange:this.handleCheckbox,name:"is7"}),React.createElement("span",null))),React.createElement("div",{className:"col-md-2"},React.createElement("label",{className:"mt-checkbox status-checkbox"},"8",React.createElement("input",{type:"checkbox",checked:1==this.state.form.data.is8,onChange:this.handleCheckbox,name:"is8"}),React.createElement("span",null))),React.createElement("div",{className:"col-md-2"},React.createElement("label",{className:"mt-checkbox status-checkbox"},"9",React.createElement("input",{type:"checkbox",checked:1==this.state.form.data.is9,onChange:this.handleCheckbox,name:"is9"}),React.createElement("span",null))),React.createElement("div",{className:"col-md-2"},React.createElement("label",{className:"mt-checkbox status-checkbox"},"10",React.createElement("input",{type:"checkbox",checked:1==this.state.form.data.is10,onChange:this.handleCheckbox,name:"is10"}),React.createElement("span",null))),React.createElement("div",{className:"col-md-12"},React.createElement(FormGroup,{controlId:"formRemarks",validationState:this.getValidationState("remarks")},React.createElement(ControlLabel,null," Remarks : "),React.createElement("textarea",{rows:"2",value:this.state.form.data.remarks,className:"input-sm form-control",onChange:this.setFormProp,name:"remarks"}),React.createElement(HelpBlock,null,this.getError("remarks"))))))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12 text-right"},React.createElement("button",{className:"btn btn-primary btn-sm",style:{marginRight:"10px"},disabled:this.isEmpty(this.state.form.data.voterId),type:"submit"}," Submit "),React.createElement("button",{className:"btn btn-default btn-sm",type:"button",onClick:this.props.onHide}," Close "))))))}});window.SpecialOptCreateLeaderModal=SpecialOptCreateLeaderModal;var SpecialOptDatatableComponent=React.createClass({displayName:"SpecialOptDatatableComponent",getInitialState:function(){return{showViewModal:!1,showReleaseModal:!1,target:null,typingTimer:null,doneTypingInterval:1500}},componentDidMount:function(){this.initGrid()},initGrid:function(){var e=new Datatable,t=this;e.init({src:$("#special_opt_datatable"),dataTable:{ordering:!1,serverSide:!0,processing:!0,searching:!1,deferRender:!0,autoWidth:!1,dom:'<"top"fpli>rt<"bottom"pli><"clear">',searchDelay:2e3,language:{processing:'<i class="fa fa-spinner fa-pulse fa-fw"></i><span > Loading...</span>.'},lengthMenu:[[10,20,50,100,150],[10,20,50,100,150]],pageLength:10,ajax:{url:Routing.generate("ajax_get_special_opt_datatable"),type:"GET",data:function(e){e.electId=t.props.electId,e.proId=t.props.proId}},columns:[{data:null,className:"text-center",width:30,render:function(e,t,a,l){return l.settings._iDisplayStart+l.row+1}},{data:"voter_name"},{data:"voter_group",width:40,className:"text-center"},{data:"barangay_name",width:80,className:"text-center"},{data:"cellphone",width:60,className:"text-center"},{data:"total_members",width:60,className:"text-center"},{data:"updated_at",width:150,className:"text-center",render:function(e){return moment(e).format("MMM DD, YYYY hh:mm A")}},{data:"updated_by",className:"text-center",width:80},{width:120,className:"text-center",render:function(e,t,a){return'<button class="btn btn-xs btn-view btn-primary"> View </button><button class="btn btn-xs delete-btn btn-danger"> Remove </button>'}}]}}),$("#special_opt_datatable tbody").on("click",".btn-view",function(){var a=e.getDataTable().row($(this).parents("tr")).data();t.openViewModal(a.hdr_id)}),$("#special_opt_datatable tbody").on("click",".release-btn",function(){var a=e.getDataTable().row($(this).parents("tr")).data();t.openReleaseModal(a.hdr_id)}),$("#special_opt_datatable tbody").on("click",".delete-btn",function(){var a=e.getDataTable().row($(this).parents("tr")).data();t.remove(a.hdr_id)}),t.grid=e},openViewModal:function(e){this.setState({showViewModal:!0,target:e})},closeViewModal:function(){this.setState({showViewModal:!1,target:null})},openReleaseModal:function(e){this.setState({showReleaseModal:!0,target:e})},closeReleaseModal:function(){this.setState({showReleaseModal:!1,target:null})},remove:function(e){var t=this;confirm("Are you sure you want to remove this item?")&&(t.requestDelete=$.ajax({url:Routing.generate("ajax_delete_special_opt_header",{hdrId:e}),type:"DELETE"}).done(function(e){t.reload()}))},handleFilterChange:function(){var e=this;clearTimeout(this.state.typingTimer),this.state.typingTimer=setTimeout(function(){e.reload()},this.state.doneTypingInterval)},reload:function(){this.grid.getDataTable().ajax.reload()},render:function(){return React.createElement("div",null,this.state.showViewModal&&React.createElement(SpecialOptDetailViewModal,{show:this.state.showViewModal,onHide:this.closeViewModal,hdrId:this.state.target,provinceCode:this.props.provinceCode,electId:this.props.electId,proId:this.props.proId,notify:this.props.notify}),React.createElement("table",{id:"special_opt_datatable",className:"table table-bordered"},React.createElement("thead",null,React.createElement("tr",{className:"text-center"},React.createElement("td",null,"#"),React.createElement("td",null,"Name"),React.createElement("td",null,"Position"),React.createElement("td",null,"Brgy"),React.createElement("td",null,"Cellphone"),React.createElement("td",null,"Members"),React.createElement("td",null,"Last Update"),React.createElement("td",null,"Updated By"),React.createElement("td",null)),React.createElement("tr",null,React.createElement("td",null),React.createElement("td",null,React.createElement("input",{type:"text",className:"form-control form-filter input-sm",name:"submitted_by"})),React.createElement("td",null,React.createElement("input",{type:"text",className:"form-control form-filter input-sm",name:"submitted_at"})),React.createElement("td",null),React.createElement("td",null),React.createElement("td",null),React.createElement("td",null),React.createElement("td",null),React.createElement("td",{className:"text-right"},React.createElement("button",{className:"btn btn-xs green btn-outline filter-submit"},React.createElement("i",{className:"fa fa-search"}),"Search")))),React.createElement("tbody",null)))}});window.SpecialOptDatatableComponent=SpecialOptDatatableComponent;var SpecialOptComponent=React.createClass({displayName:"SpecialOptComponent",getInitialState:function(){return{showCreateModal:!1,user:null,filters:{proId:null,electId:null,provinceCode:null}}},notify:function(e,t){$.notific8("zindex",11500),$.notific8(e,{heading:"System Message",color:t,life:5e3,verticalEdge:"right",horizontalEdge:"top"})},componentDidMount:function(){this.initSelect2(),this.loadUser(window.userId)},loadUser:function(e){var t=this;t.requestUser=$.ajax({url:Routing.generate("ajax_get_user",{id:e}),type:"GET"}).done(function(e){t.setState({user:e},t.reinitSelect2)})},initSelect2:function(){var e=this;$("#special_opts_component #election_select2").select2({casesentitive:!1,placeholder:"Select Election...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_elections"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.elect_id,text:e.elect_name}})}}}}),$("#special_opts_component #project_select2").select2({casesentitive:!1,placeholder:"Select Project...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_projects"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.pro_id,text:e.pro_name}})}}}}),$("#special_opts_component #province_select2").select2({casesentitive:!1,placeholder:"Enter Province...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_province"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.province_code,text:e.name}})}}}}),$("#special_opts_component #election_select2").on("change",function(){var t=e.state.filters;t.electId=$(this).val(),e.setState({filters:t})}),$("#special_opts_component #project_select2").on("change",function(){var t=e.state.filters;t.proId=$(this).val(),e.setState({filters:t})}),$("#special_opts_component #province_select2").on("change",function(){var t=e.state.filters;t.provinceCode=$(this).val(),e.setState({filters:t})})},reinitSelect2:function(){var e=this;if(!e.isEmpty(e.state.user.project)){var t=e.state.user.project.provinceCode;e.requestProvince=$.ajax({url:Routing.generate("ajax_get_province",{provinceCode:t}),type:"GET"}).done(function(e){$("#special_opts_component #province_select2").empty().append($("<option/>").val(e.province_code).text(e.name)).trigger("change")}),e.requestProject=$.ajax({url:Routing.generate("ajax_get_project",{proId:e.state.user.project.proId}),type:"GET"}).done(function(e){$("#special_opts_component #project_select2").empty().append($("<option/>").val(e.proId).text(e.proName)).trigger("change")})}e.requestActiveElection=$.ajax({url:Routing.generate("ajax_get_active_election"),type:"GET"}).done(function(e){$("#special_opts_component #election_select2").empty().append($("<option/>").val(e.electId).text(e.electName)).trigger("change")}),e.state.user.isAdmin||($("#special_opts_component #election_select2").attr("disabled","disabled"),$("#special_opts_component #province_select2").attr("disabled","disabled"),$("#special_opts_component #project_select2").attr("disabled","disabled"))},openCreateLeaderModal:function(){this.setState({showCreateModal:!0})},closeNewRequestModal:function(){this.setState({showCreateModal:!1})},isEmpty:function(e){return null==e||""==e||"undefined"==e||e<=0},reloadDatatable:function(){this.refs.SpecialOptDatatable.reload()},render:function(){return React.createElement("div",{className:"portlet light portlet-fit bordered",id:"special_opts_component"},React.createElement("div",{className:"portlet-body"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-5"},React.createElement("div",null,React.createElement("h3",null,"Special Operations")),React.createElement("button",{type:"button",onClick:this.openCreateLeaderModal,className:"btn btn-sm green"},"New Leader"),this.state.showCreateModal&&React.createElement(SpecialOptCreateLeaderModal,{proId:this.state.filters.proId,electId:this.state.filters.electId,provinceCode:this.state.filters.provinceCode,notify:this.notify,show:this.state.showCreateModal,onHide:this.closeNewRequestModal,onSuccess:this.reloadDatatable})),React.createElement("div",{className:"col-md-7"},React.createElement("form",null,React.createElement("div",{className:"col-md-3 col-md-offset-1"},React.createElement("select",{id:"election_select2",className:"form-control form-filter input-sm"})),React.createElement("div",{className:"col-md-4"},React.createElement("select",{id:"province_select2",className:"form-control form-filter input-sm"})),React.createElement("div",{className:"col-md-4"},React.createElement("select",{id:"project_select2",className:"form-control form-filter input-sm"}))))),React.createElement("br",null),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12"},React.createElement(SpecialOptDatatableComponent,{proId:this.state.filters.proId,electId:this.state.filters.electId,provinceCode:this.state.filters.provinceCode,notify:this.notify,ref:"SpecialOptDatatable"})))))}});setTimeout(function(){ReactDOM.render(React.createElement(SpecialOptComponent,null),document.getElementById("component-container"))},500);