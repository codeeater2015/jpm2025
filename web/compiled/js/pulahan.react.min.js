var Modal=ReactBootstrap.Modal,FormGroup=ReactBootstrap.FormGroup,HelpBlock=ReactBootstrap.HelpBlock,ControlLabel=ReactBootstrap.ControlLabel,FormControl=ReactBootstrap.FormControl,PulahanCreateModal=React.createClass({displayName:"PulahanCreateModal",getInitialState:function(){return{form:{data:{proVoterId:null},errors:[]}}},render:function(){return React.createElement(Modal,{style:{marginTop:"10px"},keyboard:!1,enforceFocus:!1,backdrop:"static",show:this.props.show,onHide:this.props.onHide},React.createElement(Modal.Header,{className:"modal-header bg-blue-dark font-white",closeButton:!0},React.createElement(Modal.Title,null,"Kalaban Form ")),React.createElement(Modal.Body,{bsClass:"modal-body overflow-auto"},React.createElement("form",{id:"voter-recruit-create-form",onSubmit:this.submit},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12"},React.createElement(FormGroup,{controlId:"formVoterId",validationState:this.getValidationState("voterId")},React.createElement(ControlLabel,null," Voter Name : "),React.createElement("select",{id:"voter-recruit-select2",className:"form-control input-sm"}),React.createElement(HelpBlock,null,this.getError("voterId"))),React.createElement("div",{className:"col-md-6",style:{paddingLeft:"0"}},React.createElement(FormGroup,{controlId:"formCellphoneNo",validationState:this.getValidationState("cellphone")},React.createElement(ControlLabel,null," CellphoneNo : "),React.createElement("input",{type:"text",placeholder:"Example : 09283182013",value:this.state.form.data.cellphone,className:"input-sm form-control",onChange:this.setFormProp,name:"cellphone"}),React.createElement(HelpBlock,null,this.getError("cellphone")))),React.createElement("div",{className:"col-md-6",style:{paddingRight:"0"}},React.createElement(FormGroup,{controlId:"formVoterGroup",validationState:this.getValidationState("voterGroup")},React.createElement(ControlLabel,null,"Position : "),React.createElement("select",{id:"voter-group-select2",className:"form-control input-sm"},React.createElement("option",{value:""}," ")),React.createElement(HelpBlock,null,this.getError("voterGroup")))),React.createElement("div",{className:"col-md-6",style:{paddingLeft:"0"}},React.createElement(FormGroup,{controlId:"formIsKalabanReason",validationState:this.getValidationState("isKalabanReason")},React.createElement(ControlLabel,null,"Reason : "),React.createElement("select",{id:"is-kalaban-reason-select2",className:"form-control input-sm"},React.createElement("option",{value:""}," ")),React.createElement(HelpBlock,null,this.getError("isKalabanReason")))))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-12 text-right"},React.createElement("button",{className:"btn btn-primary btn-sm",disabled:this.isEmpty(this.state.form.data.proVoterId),type:"submit"}," Submit "),React.createElement("button",{className:"btn btn-default btn-sm",type:"button",onClick:this.props.onHide}," Close "))))))},componentDidMount:function(){this.initSelect2()},initSelect2:function(){var e=this;$("#voter-recruit-select2").select2({casesentitive:!1,placeholder:"Enter Name...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",dropdownCssClass:"custom-option",ajax:{url:Routing.generate("ajax_select2_project_voters"),data:function(t){return{searchText:t.term,electId:e.props.electId,proId:e.props.proId,provinceCode:e.props.provinceCode,municipalityNo:e.props.municipalityNo,brgyNo:e.props.brgyNo}},processResults:function(e,t){return{results:e.map(function(e){var t=1==parseInt(e.has_photo)?"Y":"N",a=1==parseInt(e.has_id)?"Y : "+e.date_generated:"N";console.log(e);var r=e.voter_name+" - PHOTO("+t+") ID("+a+") "+e.precinct_no+" ( "+e.municipality_name+", "+e.barangay_name+" )";return{id:e.pro_voter_id,text:r}})}}}}),$("#voter-group-select2").select2({casesentitive:!1,placeholder:"Enter Group",width:"100%",allowClear:!0,tags:!0,containerCssClass:":all:",createTag:function(e){return{id:e.term,text:e.term,newOption:!0}},ajax:{url:Routing.generate("ajax_select2_voter_group"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.voter_group,text:e.voter_group}})}}}}),$("#is-kalaban-reason-select2").select2({casesentitive:!1,placeholder:"Enter Reason",width:"100%",allowClear:!0,tags:!0,containerCssClass:":all:",createTag:function(e){return{id:e.term,text:e.term,newOption:!0}},ajax:{url:Routing.generate("ajax_select2_is_kalaban_reason"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.voter_group,text:e.voter_group}})}}}}),$("#voter-recruit-select2").on("change",function(){e.loadVoter(e.props.proId,$(this).val())}),$("#voter-group-select2").on("change",function(){e.setFormPropValue("voterGroup",$(this).val())}),$("#is-kalaban-reason-select2").on("change",function(){e.setFormPropValue("isKalabanReason",$(this).val())})},loadVoter:function(e,t){var a=this;a.requestVoter=$.ajax({url:Routing.generate("ajax_get_project_voter",{proId:e,proVoterId:t}),type:"GET"}).done(function(e){var t=a.state.form;t.data.proVoterId=e.proVoterId,t.data.voterId=e.voterId,t.data.cellphone=a.isEmpty(e.cellphoneNo)?"":e.cellphoneNo,t.data.voterGroup=a.isEmpty(e.voterGroup)?"":e.voterGroup,$("#voter-group-select2").empty().append($("<option/>").val(t.data.voterGroup).text(t.data.voterGroup)).trigger("change"),a.setState({form:t})})},setFormPropValue:function(e,t){var a=this.state.form;a.data[e]=t,this.setState({form:a})},setFormProp:function(e){var t=this.state.form;t.data[e.target.name]=e.target.value,this.setState({form:t})},handleCheckbox:function(e){var t=this.state.form;t.data[e.target.name]=e.target.checked?1:0,this.setState({form:t})},setErrors:function(e){var t=this.state.form;t.errors=e,this.setState({form:t})},getError:function(e){var t=this.state.form.errors;for(var a in t)if(a==e)return t[e];return null},getValidationState:function(e){return null!=this.getError(e)?"error":""},isEmpty:function(e){return null==e||""==e},reset:function(){var e=this.state.form;e.data.proVoterId="",e.data.voterId="",e.data.voterGroup="",e.data.cellphone="",e.data.isKalaban=0,e.data.isKalabanReason="",e.errors=[],$("#voter-recruit-select2").empty().trigger("change"),$("#voter-group-select2").empty().trigger("change"),this.setState({form:e})},submit:function(e){e.preventDefault();var t=this,a=t.state.form.data;a.proId=t.props.proId,a.isKalaban=1,console.log("form data"),console.log(a),t.requestPost=$.ajax({url:Routing.generate("ajax_patch_project_voter_pulahan",{proId:t.props.proId,proVoterId:a.proVoterId}),data:a,type:"PATCH"}).done(function(e){t.reset(),t.props.reload()}).fail(function(e){t.setErrors(e.responseJSON)})}});window.PulahanCreateModal=PulahanCreateModal;var PulahanDatatable=React.createClass({displayName:"PulahanDatatable",getInitialState:function(){return{showCreateModal:!1,target:null,typingTimer:null,doneTypingInterval:1500,user:null,filters:{electId:null,provinceCode:null,proId:null}}},componentDidMount:function(){this.loadUser(window.userId),this.initSelect2()},loadUser:function(e){var t=this;t.requestUser=$.ajax({url:Routing.generate("ajax_get_user",{id:e}),type:"GET"}).done(function(e){t.setState({user:e},t.reinitSelect2)})},initSelect2:function(){var e=this;$("#handler_component #election_select2").select2({casesentitive:!1,placeholder:"Select Election...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_elections"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.elect_id,text:e.elect_name}})}}}}),$("#handler_component #project_select2").select2({casesentitive:!1,placeholder:"Select Project...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_projects"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.pro_id,text:e.pro_name}})}}}}),$("#handler_component #province_select2").select2({casesentitive:!1,placeholder:"Enter Province...",allowClear:!0,delay:1500,width:"100%",containerCssClass:":all:",ajax:{url:Routing.generate("ajax_select2_province_strict"),data:function(e){return{searchText:e.term}},processResults:function(e,t){return{results:e.map(function(e){return{id:e.province_code,text:e.name}})}}}}),$("#handler_component #election_select2").on("change",function(){var t=e.state.filters;t.electId=$(this).val(),e.setState({filters:t},e.reload)}),$("#handler_component #project_select2").on("change",function(){var t=e.state.filters;t.proId=$(this).val(),e.setState({filters:t},e.reload)}),$("#handler_component #province_select2").on("change",function(){var t=e.state.filters;t.provinceCode=$(this).val(),e.setState({filters:t},e.reload)})},reinitSelect2:function(){var e=this;if(!e.isEmpty(e.state.user.project)){var t=e.state.user.project.provinceCode;e.requestProvince=$.ajax({url:Routing.generate("ajax_get_province",{provinceCode:t}),type:"GET"}).done(function(e){$("#handler_component #province_select2").empty().append($("<option/>").val(e.province_code).text(e.name)).trigger("change")}),e.requestProject=$.ajax({url:Routing.generate("ajax_get_project",{proId:e.state.user.project.proId}),type:"GET"}).done(function(t){$("#handler_component #project_select2").empty().append($("<option/>").val(t.proId).text(t.proName)).trigger("change"),e.initDatatable()})}e.requestActiveElection=$.ajax({url:Routing.generate("ajax_get_active_election"),type:"GET"}).done(function(e){$("#handler_component #election_select2").empty().append($("<option/>").val(e.electId).text(e.electName)).trigger("change")}),e.state.user.isAdmin||($("#handler_component #election_select2").attr("disabled","disabled"),$("#handler_component #province_select2").attr("disabled","disabled"),$("#handler_component #project_select2").attr("disabled","disabled"))},initDatatable:function(){var e=this,t=(new Datatable,$("#project_recruitment_table")),a=new Datatable,r=Routing.generate("ajax_pulahan_datatable",{},!0);a.init({src:t,loadingMessage:"Loading...",dataTable:{bState:!0,autoWidth:!0,deferRender:!0,ajax:{url:r,type:"GET",data:function(e){e.electId=$("#handler_component #election_select2").val(),e.provinceCode=$("#handler_component #province_select2").val(),e.proId=$("#handler_component #project_select2").val(),e.voterName=$('#project_recruitment_table input[name="voter_name"]').val(),e.municipalityName=$('#project_recruitment_table input[name="municipality_name"]').val(),e.barangayName=$('#project_recruitment_table input[name="barangay_name"]').val()}},columnDefs:[{orderable:!1,targets:[0,2,3,4]},{className:"align-center",targets:[0,3]}],order:[[0,"desc"]],columns:[{data:null,className:"text-center",width:30,render:function(e,t,a,r){return r.settings._iDisplayStart+r.row+1}},{data:"voter_name",render:function(e,t,a){return e+(1==a.has_id?"*":"")}},{data:"municipality_name",width:150},{data:"barangay_name",width:150},{data:"has_photo",className:"text-center",width:80},{data:"is_kalaban_reason",className:"text-center",width:150},{data:"is_kalaban",className:"text-center",width:30,render:function(e,t,a){return'<label class="mt-checkbox status-checkbox"><input type="checkbox" name="isKalaban" '+(1==parseInt(e)?' checked="checked" ':"")+' value="'+a.pro_voter_id+'"></input><span></span></label>'}}]}}),t.on("click",".status-checkbox",function(t){var a=t.target.value,r=t.target.checked,n=t.target.name,o=r?1:0;null!=a&&null!=r&&e.patchStatus(a,n,o)}),e.grid=a},closeCreateModal:function(){this.setState({showCreateModal:!1,target:null})},closeRecruitsModal:function(){this.setState({showRecruitsModal:!1,target:null})},openCreateModal:function(){this.setState({showCreateModal:!0})},patchStatus:function(e,t,a){var r=this,n={};n[t]=a,r.requestToggleRequirement=$.ajax({url:Routing.generate("ajax_patch_project_voter_tag_status",{proVoterId:e}),type:"PATCH",data:n}).done(function(e){r.reload()})},delete:function(e){var t=this;confirm("Are you sure you want to delete this record ?")&&(t.requestDelete=$.ajax({url:Routing.generate("ajax_delete_project_recruitment_header",{recId:e}),type:"DELETE"}).done(function(e){t.reload()}))},handleFilterChange:function(){var e=this;clearTimeout(this.state.typingTimer),this.state.typingTimer=setTimeout(function(){e.reload()},this.state.doneTypingInterval)},reload:function(){null!=this.grid&&this.grid.getDataTable().ajax.reload()},isEmpty:function(e){return null==e||""==e||"undefined"==e||e<=0},render:function(){return React.createElement("div",null,this.state.showCreateModal&&React.createElement(PulahanCreateModal,{proId:this.state.filters.proId,electId:this.state.filters.electId,provinceCode:this.state.filters.provinceCode,show:this.state.showCreateModal,notify:this.props.notify,reload:this.reload,onHide:this.closeCreateModal}),React.createElement("div",{className:"row",id:"handler_component"},React.createElement("div",{className:"col-md-5"},React.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.openCreateModal},"Add Kalaban")),React.createElement("div",{className:"col-md-7"},React.createElement("form",{onSubmit:this.onApplyCode},React.createElement("div",{className:"col-md-3 col-md-offset-1"},React.createElement("select",{id:"election_select2",className:"form-control form-filter input-sm"})),React.createElement("div",{className:"col-md-4"},React.createElement("select",{id:"province_select2",className:"form-control form-filter input-sm"})),React.createElement("div",{className:"col-md-4"},React.createElement("select",{id:"project_select2",className:"form-control form-filter input-sm"}))))),React.createElement("div",{className:"table-container",style:{marginTop:"20px"}},React.createElement("table",{id:"project_recruitment_table",className:"table table-striped table-bordered",width:"100%"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"No"),React.createElement("th",null,"Voter Name"),React.createElement("th",{className:"text-center"},"Municipality"),React.createElement("th",{className:"text-center"},"Barangay"),React.createElement("th",{className:"text-center"},"Has Photo"),React.createElement("th",{className:"text-center"},"Reason"),React.createElement("th",{className:"text-center"})),React.createElement("tr",null,React.createElement("td",null),React.createElement("td",{style:{padding:"10px 5px"}},React.createElement("input",{type:"text",className:"form-control form-filter input-sm",name:"voter_name",onChange:this.handleFilterChange})),React.createElement("td",{style:{padding:"10px 5px"}},React.createElement("input",{type:"text",className:"form-control form-filter input-sm",name:"municipality_name",onChange:this.handleFilterChange})),React.createElement("td",{style:{padding:"10px 5px"}},React.createElement("input",{type:"text",className:"form-control form-filter input-sm",name:"barangay_name",onChange:this.handleFilterChange})),React.createElement("td",null),React.createElement("td",null),React.createElement("td",null))),React.createElement("tbody",null))))}});window.PulahanDatatable=PulahanDatatable;var PulahanComponent=React.createClass({displayName:"PulahanComponent",notify:function(e,t){$.notific8("zindex",11500),$.notific8(e,{heading:"System Message",color:t,life:5e3,verticalEdge:"right",horizontalEdge:"top"})},render:function(){return React.createElement("div",{className:"portlet light portlet-fit bordered"},React.createElement("div",{className:"portlet-body"},React.createElement(PulahanDatatable,null)))}});setTimeout(function(){ReactDOM.render(React.createElement(PulahanComponent,null),document.getElementById("page-container"))},500);